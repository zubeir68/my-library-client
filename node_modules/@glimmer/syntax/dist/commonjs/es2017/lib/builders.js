'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
function buildMustache(path, params, hash, raw, loc) {
    if (typeof path === 'string') {
        path = buildPath(path);
    }
    return {
        type: 'MustacheStatement',
        path,
        params: params || [],
        hash: hash || buildHash([]),
        escaped: !raw,
        loc: buildLoc(loc || null)
    };
}
function buildBlock(path, params, hash, program, inverse, loc) {
    return {
        type: 'BlockStatement',
        path: buildPath(path),
        params: params || [],
        hash: hash || buildHash([]),
        program: program || null,
        inverse: inverse || null,
        loc: buildLoc(loc || null)
    };
}
function buildElementModifier(path, params, hash, loc) {
    return {
        type: 'ElementModifierStatement',
        path: buildPath(path),
        params: params || [],
        hash: hash || buildHash([]),
        loc: buildLoc(loc || null)
    };
}
function buildPartial(name, params, hash, indent, loc) {
    return {
        type: 'PartialStatement',
        name: name,
        params: params || [],
        hash: hash || buildHash([]),
        indent: indent || '',
        strip: { open: false, close: false },
        loc: buildLoc(loc || null)
    };
}
function buildComment(value, loc) {
    return {
        type: 'CommentStatement',
        value: value,
        loc: buildLoc(loc || null)
    };
}
function buildMustacheComment(value, loc) {
    return {
        type: 'MustacheCommentStatement',
        value: value,
        loc: buildLoc(loc || null)
    };
}
function buildConcat(parts, loc) {
    return {
        type: 'ConcatStatement',
        parts: parts || [],
        loc: buildLoc(loc || null)
    };
}
function buildElement(tag, attributes, modifiers, children, comments, blockParams, loc) {
    // this is used for backwards compat prior to `blockParams` being added to the AST
    if (Array.isArray(comments)) {
        if (isBlockParms(comments)) {
            blockParams = comments;
            comments = [];
        } else if (isLoc(blockParams)) {
            loc = blockParams;
            blockParams = [];
        }
    } else if (isLoc(comments)) {
        // this is used for backwards compat prior to `comments` being added to the AST
        loc = comments;
        comments = [];
    } else if (isLoc(blockParams)) {
        loc = blockParams;
        blockParams = [];
    }
    // this is used for backwards compat, prior to `selfClosing` being part of the ElementNode AST
    let selfClosing = false;
    if (typeof tag === 'object') {
        selfClosing = tag.selfClosing;
        tag = tag.name;
    }
    return {
        type: 'ElementNode',
        tag: tag || '',
        selfClosing: selfClosing,
        attributes: attributes || [],
        blockParams: blockParams || [],
        modifiers: modifiers || [],
        comments: comments || [],
        children: children || [],
        loc: buildLoc(loc || null)
    };
}
function buildAttr(name, value, loc) {
    return {
        type: 'AttrNode',
        name: name,
        value: value,
        loc: buildLoc(loc || null)
    };
}
function buildText(chars, loc) {
    return {
        type: 'TextNode',
        chars: chars || '',
        loc: buildLoc(loc || null)
    };
}
// Expressions
function buildSexpr(path, params, hash, loc) {
    return {
        type: 'SubExpression',
        path: buildPath(path),
        params: params || [],
        hash: hash || buildHash([]),
        loc: buildLoc(loc || null)
    };
}
function buildPath(original, loc) {
    if (typeof original !== 'string') return original;
    let parts = original.split('.');
    let thisHead = false;
    if (parts[0] === 'this') {
        thisHead = true;
        parts = parts.slice(1);
    }
    return {
        type: 'PathExpression',
        original,
        this: thisHead,
        parts,
        data: false,
        loc: buildLoc(loc || null)
    };
}
function buildLiteral(type, value, loc) {
    return {
        type,
        value,
        original: value,
        loc: buildLoc(loc || null)
    };
}
// Miscellaneous
function buildHash(pairs, loc) {
    return {
        type: 'Hash',
        pairs: pairs || [],
        loc: buildLoc(loc || null)
    };
}
function buildPair(key, value, loc) {
    return {
        type: 'HashPair',
        key: key,
        value,
        loc: buildLoc(loc || null)
    };
}
function buildProgram(body, blockParams, loc) {
    return {
        type: 'Program',
        body: body || [],
        blockParams: blockParams || [],
        loc: buildLoc(loc || null)
    };
}
function buildSource(source) {
    return source || null;
}
function buildPosition(line, column) {
    return {
        line,
        column
    };
}
const SYNTHETIC = exports.SYNTHETIC = {
    source: '(synthetic)',
    start: { line: 1, column: 0 },
    end: { line: 1, column: 0 }
};
function buildLoc(...args) {
    if (args.length === 1) {
        let loc = args[0];
        if (loc && typeof loc === 'object') {
            return {
                source: buildSource(loc.source),
                start: buildPosition(loc.start.line, loc.start.column),
                end: buildPosition(loc.end.line, loc.end.column)
            };
        } else {
            return SYNTHETIC;
        }
    } else {
        let [startLine, startColumn, endLine, endColumn, source] = args;
        return {
            source: buildSource(source),
            start: buildPosition(startLine, startColumn),
            end: buildPosition(endLine, endColumn)
        };
    }
}
function isBlockParms(arr) {
    return arr[0] === 'string';
}
function isLoc(item) {
    return !Array.isArray(item);
}
exports.default = {
    mustache: buildMustache,
    block: buildBlock,
    partial: buildPartial,
    comment: buildComment,
    mustacheComment: buildMustacheComment,
    element: buildElement,
    elementModifier: buildElementModifier,
    attr: buildAttr,
    text: buildText,
    sexpr: buildSexpr,
    path: buildPath,
    concat: buildConcat,
    hash: buildHash,
    pair: buildPair,
    literal: buildLiteral,
    program: buildProgram,
    loc: buildLoc,
    pos: buildPosition,
    string: literal('StringLiteral'),
    boolean: literal('BooleanLiteral'),
    number: literal('NumberLiteral'),
    undefined() {
        return buildLiteral('UndefinedLiteral', undefined);
    },
    null() {
        return buildLiteral('NullLiteral', null);
    }
};

function literal(type) {
    return function (value) {
        return buildLiteral(type, value);
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVpbGRlcnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9zeW50YXgvbGliL2J1aWxkZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBUUEsdUJBQ0UsQUFBK0IsTUFDL0IsQUFBeUIsUUFDekIsQUFBZSxNQUNmLEFBQWEsS0FDYixBQUF3QixLQUV4QjtRQUFJLE9BQU8sQUFBSSxTQUFLLEFBQVEsVUFBRSxBQUM1QixBQUFJO2VBQUcsQUFBUyxVQUFDLEFBQUksQUFBQyxBQUFDLEFBQ3hCO0FBRUQ7O2NBQ1EsQUFBbUIsQUFDekIsQUFBSTtBQUNKLEFBQU07Z0JBQUUsQUFBTSxVQUFJLEFBQUUsQUFDcEIsQUFBSTtjQUFFLEFBQUksUUFBSSxBQUFTLFVBQUMsQUFBRSxBQUFDLEFBQzNCLEFBQU87aUJBQUUsQ0FBQyxBQUFHLEFBQ2IsQUFBRzthQUFFLEFBQVEsU0FBQyxBQUFHLE9BTlosQUFNZ0IsQUFBSSxBQUFDLEFBQzNCLEFBQUMsQUFDSixBQUFDO0FBUEcsQUFBSTs7QUFTUixvQkFDRSxBQUFpQixNQUNqQixBQUFnQyxRQUNoQyxBQUFzQixNQUN0QixBQUFvQixTQUNwQixBQUE2QixTQUM3QixBQUF3QixLQUV4Qjs7Y0FDUSxBQUFnQixBQUN0QixBQUFJO2NBQUUsQUFBUyxVQUFDLEFBQUksQUFBQyxBQUNyQixBQUFNO2dCQUFFLEFBQU0sVUFBSSxBQUFFLEFBQ3BCLEFBQUk7Y0FBRSxBQUFJLFFBQUksQUFBUyxVQUFDLEFBQUUsQUFBQyxBQUMzQixBQUFPO2lCQUFFLEFBQU8sV0FBSSxBQUFJLEFBQ3hCLEFBQU87aUJBQUUsQUFBTyxXQUFJLEFBQUksQUFDeEIsQUFBRzthQUFFLEFBQVEsU0FBQyxBQUFHLE9BUFosQUFPZ0IsQUFBSSxBQUFDLEFBQzNCLEFBQUMsQUFDSixBQUFDO0FBUkcsQUFBSTs7QUFVUiw4QkFDRSxBQUFpQixNQUNqQixBQUF5QixRQUN6QixBQUFlLE1BQ2YsQUFBZ0MsS0FFaEM7O2NBQ1EsQUFBMEIsQUFDaEMsQUFBSTtjQUFFLEFBQVMsVUFBQyxBQUFJLEFBQUMsQUFDckIsQUFBTTtnQkFBRSxBQUFNLFVBQUksQUFBRSxBQUNwQixBQUFJO2NBQUUsQUFBSSxRQUFJLEFBQVMsVUFBQyxBQUFFLEFBQUMsQUFDM0IsQUFBRzthQUFFLEFBQVEsU0FBQyxBQUFHLE9BTFosQUFLZ0IsQUFBSSxBQUFDLEFBQzNCLEFBQUMsQUFDSixBQUFDO0FBTkcsQUFBSTs7QUFRUixzQkFDRSxBQUF3QixNQUN4QixBQUF5QixRQUN6QixBQUFlLE1BQ2YsQUFBZSxRQUNmLEFBQXdCLEtBRXhCOztjQUNRLEFBQWtCLEFBQ3hCLEFBQUk7Y0FBRSxBQUFJLEFBQ1YsQUFBTTtnQkFBRSxBQUFNLFVBQUksQUFBRSxBQUNwQixBQUFJO2NBQUUsQUFBSSxRQUFJLEFBQVMsVUFBQyxBQUFFLEFBQUMsQUFDM0IsQUFBTTtnQkFBRSxBQUFNLFVBQUksQUFBRSxBQUNwQixBQUFLO2VBQUUsRUFBRSxBQUFJLE1BQUUsQUFBSyxPQUFFLEFBQUssT0FBRSxBQUFLLEFBQUUsQUFDcEMsQUFBRzthQUFFLEFBQVEsU0FBQyxBQUFHLE9BUFosQUFPZ0IsQUFBSSxBQUFDLEFBQzNCLEFBQUMsQUFDSixBQUFDO0FBUkcsQUFBSTs7QUFVUixzQkFBc0IsQUFBYSxPQUFFLEFBQXdCLEtBQzNEOztjQUNRLEFBQWtCLEFBQ3hCLEFBQUs7ZUFBRSxBQUFLLEFBQ1osQUFBRzthQUFFLEFBQVEsU0FBQyxBQUFHLE9BSFosQUFHZ0IsQUFBSSxBQUFDLEFBQzNCLEFBQUMsQUFDSixBQUFDO0FBSkcsQUFBSTs7QUFNUiw4QkFDRSxBQUFhLE9BQ2IsQUFBd0IsS0FFeEI7O2NBQ1EsQUFBMEIsQUFDaEMsQUFBSztlQUFFLEFBQUssQUFDWixBQUFHO2FBQUUsQUFBUSxTQUFDLEFBQUcsT0FIWixBQUdnQixBQUFJLEFBQUMsQUFDM0IsQUFBQyxBQUNKLEFBQUM7QUFKRyxBQUFJOztBQU1SLHFCQUNFLEFBQStDLE9BQy9DLEFBQXdCLEtBRXhCOztjQUNRLEFBQWlCLEFBQ3ZCLEFBQUs7ZUFBRSxBQUFLLFNBQUksQUFBRSxBQUNsQixBQUFHO2FBQUUsQUFBUSxTQUFDLEFBQUcsT0FIWixBQUdnQixBQUFJLEFBQUMsQUFDM0IsQUFBQyxBQUNKLEFBQUM7QUFKRyxBQUFJOztBQXlCUixzQkFDRSxBQUFrQixLQUNsQixBQUEyQixZQUMzQixBQUEwQyxXQUMxQyxBQUEwQixVQUMxQixBQUF5RSxVQUN6RSxBQUFzQixhQUN0QixBQUF3QixLQUV4QixBQUFrRjtBQUNsRjtRQUFJLEFBQUssTUFBQyxBQUFPLFFBQUMsQUFBUSxBQUFDLFdBQUUsQUFDM0I7WUFBSSxBQUFZLGFBQUMsQUFBUSxBQUFDLFdBQUUsQUFDMUIsQUFBVzswQkFBRyxBQUFRLEFBQUMsQUFDdkIsQUFBUTt1QkFBRyxBQUFFLEFBQUMsQUFDZjtlQUFNLElBQUksQUFBSyxNQUFDLEFBQVcsQUFBQyxjQUFFLEFBQzdCLEFBQUc7a0JBQUcsQUFBVyxBQUFDLEFBQ2xCLEFBQVc7MEJBQUcsQUFBRSxBQUFDLEFBQ2xCO0FBQ0Y7ZUFBVSxBQUFLLE1BQUMsQUFBUSxBQUFDLFdBQUUsQUFDMUIsQUFBK0U7QUFDL0UsQUFBRztjQUFHLEFBQVEsQUFBQyxBQUNmLEFBQVE7bUJBQUcsQUFBRSxBQUFDLEFBQ2Y7QUFKTSxXQUlBLElBQUksQUFBSyxNQUFDLEFBQVcsQUFBQyxjQUFFLEFBQzdCLEFBQUc7Y0FBRyxBQUFXLEFBQUMsQUFDbEIsQUFBVztzQkFBRyxBQUFFLEFBQUMsQUFDbEI7QUFFRCxBQUE4RjtBQUM5RjtRQUFJLEFBQVcsY0FBRyxBQUFLLEFBQUMsQUFDeEI7UUFBSSxPQUFPLEFBQUcsUUFBSyxBQUFRLFVBQUUsQUFDM0IsQUFBVztzQkFBRyxBQUFHLElBQUMsQUFBVyxBQUFDLEFBQzlCLEFBQUc7Y0FBRyxBQUFHLElBQUMsQUFBSSxBQUFDLEFBQ2hCO0FBRUQ7O2NBQ1EsQUFBYSxBQUNuQixBQUFHO2FBQUUsQUFBRyxPQUFJLEFBQUUsQUFDZCxBQUFXO3FCQUFFLEFBQVcsQUFDeEIsQUFBVTtvQkFBRSxBQUFVLGNBQUksQUFBRSxBQUM1QixBQUFXO3FCQUFFLEFBQVcsZUFBSSxBQUFFLEFBQzlCLEFBQVM7bUJBQUUsQUFBUyxhQUFJLEFBQUUsQUFDMUIsQUFBUTtrQkFBRyxBQUEyQyxZQUFJLEFBQUUsQUFDNUQsQUFBUTtrQkFBRSxBQUFRLFlBQUksQUFBRSxBQUN4QixBQUFHO2FBQUUsQUFBUSxTQUFDLEFBQUcsT0FUWixBQVNnQixBQUFJLEFBQUMsQUFDM0IsQUFBQyxBQUNKLEFBQUM7QUFWRyxBQUFJOztBQVlSLG1CQUNFLEFBQVksTUFDWixBQUE0QixPQUM1QixBQUF3QixLQUV4Qjs7Y0FDUSxBQUFVLEFBQ2hCLEFBQUk7Y0FBRSxBQUFJLEFBQ1YsQUFBSztlQUFFLEFBQUssQUFDWixBQUFHO2FBQUUsQUFBUSxTQUFDLEFBQUcsT0FKWixBQUlnQixBQUFJLEFBQUMsQUFDM0IsQUFBQyxBQUNKLEFBQUM7QUFMRyxBQUFJOztBQU9SLG1CQUFtQixBQUFjLE9BQUUsQUFBd0IsS0FDekQ7O2NBQ1EsQUFBVSxBQUNoQixBQUFLO2VBQUUsQUFBSyxTQUFJLEFBQUUsQUFDbEIsQUFBRzthQUFFLEFBQVEsU0FBQyxBQUFHLE9BSFosQUFHZ0IsQUFBSSxBQUFDLEFBQzNCLEFBQUMsQUFDSixBQUFDO0FBSkcsQUFBSTs7QUFNUixBQUFjO0FBRWQsb0JBQ0UsQUFBaUIsTUFDakIsQUFBeUIsUUFDekIsQUFBZSxNQUNmLEFBQXdCLEtBRXhCOztjQUNRLEFBQWUsQUFDckIsQUFBSTtjQUFFLEFBQVMsVUFBQyxBQUFJLEFBQUMsQUFDckIsQUFBTTtnQkFBRSxBQUFNLFVBQUksQUFBRSxBQUNwQixBQUFJO2NBQUUsQUFBSSxRQUFJLEFBQVMsVUFBQyxBQUFFLEFBQUMsQUFDM0IsQUFBRzthQUFFLEFBQVEsU0FBQyxBQUFHLE9BTFosQUFLZ0IsQUFBSSxBQUFDLEFBQzNCLEFBQUMsQUFDSixBQUFDO0FBTkcsQUFBSTs7QUFRUixtQkFBbUIsQUFBcUIsVUFBRSxBQUF3QixLQUNoRTtRQUFJLE9BQU8sQUFBUSxhQUFLLEFBQVEsVUFBRSxPQUFPLEFBQVEsQUFBQyxBQUVsRDtRQUFJLEFBQUssUUFBRyxBQUFRLFNBQUMsQUFBSyxNQUFDLEFBQUcsQUFBQyxBQUFDLEFBQ2hDO1FBQUksQUFBUSxXQUFHLEFBQUssQUFBQyxBQUVyQjtRQUFJLEFBQUssTUFBQyxBQUFDLEFBQUMsT0FBSyxBQUFNLFFBQUUsQUFDdkIsQUFBUTttQkFBRyxBQUFJLEFBQUMsQUFDaEIsQUFBSztnQkFBRyxBQUFLLE1BQUMsQUFBSyxNQUFDLEFBQUMsQUFBQyxBQUFDLEFBQ3hCO0FBRUQ7O2NBQ1EsQUFBZ0IsQUFDdEIsQUFBUTtBQUNSLEFBQUk7Y0FBRSxBQUFRLEFBQ2QsQUFBSztBQUNMLEFBQUk7Y0FBRSxBQUFLLEFBQ1gsQUFBRzthQUFFLEFBQVEsU0FBQyxBQUFHLE9BTlosQUFNZ0IsQUFBSSxBQUFDLEFBQzNCLEFBQUMsQUFDSixBQUFDO0FBUEcsQUFBSTs7QUFTUixzQkFDRSxBQUFlLE1BQ2YsQUFBaUIsT0FDakIsQUFBd0IsS0FFeEI7O0FBRUUsQUFBSztBQUNMLEFBQVE7a0JBQUUsQUFBSyxBQUNmLEFBQUc7YUFBRSxBQUFRLFNBQUMsQUFBRyxPQUpaLEFBSWdCLEFBQUksQUFBQyxBQUNaLEFBQUMsQUFDbkIsQUFBQztBQUxHLEFBQUk7O0FBT1IsQUFBZ0I7QUFFaEIsbUJBQW1CLEFBQXNCLE9BQUUsQUFBd0IsS0FDakU7O2NBQ1EsQUFBTSxBQUNaLEFBQUs7ZUFBRSxBQUFLLFNBQUksQUFBRSxBQUNsQixBQUFHO2FBQUUsQUFBUSxTQUFDLEFBQUcsT0FIWixBQUdnQixBQUFJLEFBQUMsQUFDM0IsQUFBQyxBQUNKLEFBQUM7QUFKRyxBQUFJOztBQU1SLG1CQUFtQixBQUFXLEtBQUUsQUFBcUIsT0FBRSxBQUF3QixLQUM3RTs7Y0FDUSxBQUFVLEFBQ2hCLEFBQUc7YUFBRSxBQUFHLEFBQ1IsQUFBSztBQUNMLEFBQUc7YUFBRSxBQUFRLFNBQUMsQUFBRyxPQUpaLEFBSWdCLEFBQUksQUFBQyxBQUMzQixBQUFDLEFBQ0osQUFBQztBQUxHLEFBQUk7O0FBT1Isc0JBQ0UsQUFBc0IsTUFDdEIsQUFBc0IsYUFDdEIsQUFBd0IsS0FFeEI7O2NBQ1EsQUFBUyxBQUNmLEFBQUk7Y0FBRSxBQUFJLFFBQUksQUFBRSxBQUNoQixBQUFXO3FCQUFFLEFBQVcsZUFBSSxBQUFFLEFBQzlCLEFBQUc7YUFBRSxBQUFRLFNBQUMsQUFBRyxPQUpaLEFBSWdCLEFBQUksQUFBQyxBQUMzQixBQUFDLEFBQ0osQUFBQztBQUxHLEFBQUk7O0FBT1IscUJBQXFCLEFBQWUsUUFDbEM7V0FBTyxBQUFNLFVBQUksQUFBSSxBQUFDLEFBQ3hCLEFBQUM7O0FBRUQsdUJBQXVCLEFBQVksTUFBRSxBQUFjLFFBQ2pEOztBQUVFLEFBQU0sQUFDUCxBQUFDLEFBQ0o7QUFKUyxBQUlSO0FBSEcsQUFBSTtBQUtSLEFBQU07TUFBTyxBQUFTO1lBQ1osQUFBYSxBQUNyQixBQUFLO1dBQUUsRUFBRSxBQUFJLE1BQUUsQUFBQyxHQUFFLEFBQU0sUUFBRSxBQUFDLEFBQUUsQUFDN0IsQUFBRztTQUFFLEVBQUUsQUFBSSxNQUFFLEFBQUMsR0FBRSxBQUFNLFFBSGpCLEFBQXNDLEFBR25CLEFBQUMsQUFBRSxBQUM1QixBQUFDO0FBSEEsQUFBTTtBQWNSLGtCQUFrQixHQUFHLEFBQVcsTUFDOUI7UUFBSSxBQUFJLEtBQUMsQUFBTSxXQUFLLEFBQUMsR0FBRSxBQUNyQjtZQUFJLEFBQUcsTUFBRyxBQUFJLEtBQUMsQUFBQyxBQUFDLEFBQUMsQUFFbEI7WUFBSSxBQUFHLE9BQUksT0FBTyxBQUFHLFFBQUssQUFBUSxVQUFFLEFBQ2xDOzt3QkFDVSxBQUFXLFlBQUMsQUFBRyxJQUFDLEFBQU0sQUFBQyxBQUMvQixBQUFLO3VCQUFFLEFBQWEsY0FBQyxBQUFHLElBQUMsQUFBSyxNQUFDLEFBQUksTUFBRSxBQUFHLElBQUMsQUFBSyxNQUFDLEFBQU0sQUFBQyxBQUN0RCxBQUFHO3FCQUFFLEFBQWEsY0FBQyxBQUFHLElBQUMsQUFBRyxJQUFDLEFBQUksTUFBRSxBQUFHLElBQUMsQUFBRyxJQUhuQyxBQUdvQyxBQUFNLEFBQUMsQUFDakQsQUFBQyxBQUNIO0FBSkcsQUFBTTtlQUlILEFBQ0w7bUJBQU8sQUFBUyxBQUFDLEFBQ2xCO0FBQ0Y7V0FBTSxBQUNMO1lBQUksQ0FBQyxBQUFTLFdBQUUsQUFBVyxhQUFFLEFBQU8sU0FBRSxBQUFTLFdBQUUsQUFBTSxBQUFDLFVBQUcsQUFBSSxBQUFDLEFBQ2hFOztvQkFDVSxBQUFXLFlBQUMsQUFBTSxBQUFDLEFBQzNCLEFBQUs7bUJBQUUsQUFBYSxjQUFDLEFBQVMsV0FBRSxBQUFXLEFBQUMsQUFDNUMsQUFBRztpQkFBRSxBQUFhLGNBQUMsQUFBTyxTQUhyQixBQUd1QixBQUFTLEFBQUMsQUFDdkMsQUFBQyxBQUNILEFBQ0g7QUFMTSxBQUFNO0FBS1g7O0FBRUQsc0JBQXNCLEFBQThDLEtBQ2xFO1dBQU8sQUFBRyxJQUFDLEFBQUMsQUFBQyxPQUFLLEFBQVEsQUFBQyxBQUM3QixBQUFDOztBQUVELGVBQ0UsQUFBZ0YsTUFFaEY7V0FBTyxDQUFDLEFBQUssTUFBQyxBQUFPLFFBQUMsQUFBSSxBQUFDLEFBQUMsQUFDOUIsQUFBQztBQUVEOztjQUNZLEFBQWEsQUFDdkIsQUFBSztXQUFFLEFBQVUsQUFDakIsQUFBTzthQUFFLEFBQVksQUFDckIsQUFBTzthQUFFLEFBQVksQUFDckIsQUFBZTtxQkFBRSxBQUFvQixBQUNyQyxBQUFPO2FBQUUsQUFBWSxBQUNyQixBQUFlO3FCQUFFLEFBQW9CLEFBQ3JDLEFBQUk7VUFBRSxBQUFTLEFBQ2YsQUFBSTtVQUFFLEFBQVMsQUFDZixBQUFLO1dBQUUsQUFBVSxBQUNqQixBQUFJO1VBQUUsQUFBUyxBQUNmLEFBQU07WUFBRSxBQUFXLEFBQ25CLEFBQUk7VUFBRSxBQUFTLEFBQ2YsQUFBSTtVQUFFLEFBQVMsQUFDZixBQUFPO2FBQUUsQUFBWSxBQUNyQixBQUFPO2FBQUUsQUFBWSxBQUNyQixBQUFHO1NBQUUsQUFBUSxBQUNiLEFBQUc7U0FBRSxBQUFhLEFBRWxCLEFBQU07WUFBRSxBQUFPLFFBQUMsQUFBZSxBQUFDLEFBQ2hDLEFBQU87YUFBRSxBQUFPLFFBQUMsQUFBZ0IsQUFBQyxBQUNsQyxBQUFNO1lBQUUsQUFBTyxRQUFDLEFBQWUsQUFBQyxBQUNoQyxBQUFTO2dCQUNQO2VBQU8sQUFBWSxhQUFDLEFBQWtCLG9CQUFFLEFBQVMsQUFBQyxBQUFDLEFBQ3JELEFBQUM7QUFDRCxBQUFJO1dBQ0Y7ZUFBTyxBQUFZLGFBQUMsQUFBYSxlQUFFLEFBQUksQUFBQyxBQUFDLEFBQzNDLEFBQUMsQUFDRixBQUFDO0FBN0JhO0FBQ2IsQUFBUTs7QUE4QlYsaUJBQXdDLEFBQWUsTUFDckQ7V0FBTyxVQUFTLEFBQWlCLE9BQy9CO2VBQU8sQUFBWSxhQUFDLEFBQUksTUFBRSxBQUFLLEFBQUMsQUFBQyxBQUNuQyxBQUFDLEFBQUMsQUFDSjtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQVNUIGZyb20gJy4vdHlwZXMvbm9kZXMnO1xuaW1wb3J0IHsgT3B0aW9uIH0gZnJvbSAnQGdsaW1tZXIvaW50ZXJmYWNlcyc7XG5cbi8vIFN0YXRlbWVudHNcblxuZXhwb3J0IHR5cGUgQnVpbGRlclBhdGggPSBzdHJpbmcgfCBBU1QuUGF0aEV4cHJlc3Npb247XG5leHBvcnQgdHlwZSBUYWdEZXNjcmlwdG9yID0gc3RyaW5nIHwgeyBuYW1lOiBzdHJpbmc7IHNlbGZDbG9zaW5nOiBib29sZWFuIH07XG5cbmZ1bmN0aW9uIGJ1aWxkTXVzdGFjaGUoXG4gIHBhdGg6IEJ1aWxkZXJQYXRoIHwgQVNULkxpdGVyYWwsXG4gIHBhcmFtcz86IEFTVC5FeHByZXNzaW9uW10sXG4gIGhhc2g/OiBBU1QuSGFzaCxcbiAgcmF3PzogYm9vbGVhbixcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQge1xuICBpZiAodHlwZW9mIHBhdGggPT09ICdzdHJpbmcnKSB7XG4gICAgcGF0aCA9IGJ1aWxkUGF0aChwYXRoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ011c3RhY2hlU3RhdGVtZW50JyxcbiAgICBwYXRoLFxuICAgIHBhcmFtczogcGFyYW1zIHx8IFtdLFxuICAgIGhhc2g6IGhhc2ggfHwgYnVpbGRIYXNoKFtdKSxcbiAgICBlc2NhcGVkOiAhcmF3LFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZEJsb2NrKFxuICBwYXRoOiBCdWlsZGVyUGF0aCxcbiAgcGFyYW1zOiBPcHRpb248QVNULkV4cHJlc3Npb25bXT4sXG4gIGhhc2g6IE9wdGlvbjxBU1QuSGFzaD4sXG4gIHByb2dyYW06IEFTVC5Qcm9ncmFtLFxuICBpbnZlcnNlPzogT3B0aW9uPEFTVC5Qcm9ncmFtPixcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuQmxvY2tTdGF0ZW1lbnQge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdCbG9ja1N0YXRlbWVudCcsXG4gICAgcGF0aDogYnVpbGRQYXRoKHBhdGgpLFxuICAgIHBhcmFtczogcGFyYW1zIHx8IFtdLFxuICAgIGhhc2g6IGhhc2ggfHwgYnVpbGRIYXNoKFtdKSxcbiAgICBwcm9ncmFtOiBwcm9ncmFtIHx8IG51bGwsXG4gICAgaW52ZXJzZTogaW52ZXJzZSB8fCBudWxsLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZEVsZW1lbnRNb2RpZmllcihcbiAgcGF0aDogQnVpbGRlclBhdGgsXG4gIHBhcmFtcz86IEFTVC5FeHByZXNzaW9uW10sXG4gIGhhc2g/OiBBU1QuSGFzaCxcbiAgbG9jPzogT3B0aW9uPEFTVC5Tb3VyY2VMb2NhdGlvbj5cbik6IEFTVC5FbGVtZW50TW9kaWZpZXJTdGF0ZW1lbnQge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdFbGVtZW50TW9kaWZpZXJTdGF0ZW1lbnQnLFxuICAgIHBhdGg6IGJ1aWxkUGF0aChwYXRoKSxcbiAgICBwYXJhbXM6IHBhcmFtcyB8fCBbXSxcbiAgICBoYXNoOiBoYXNoIHx8IGJ1aWxkSGFzaChbXSksXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkUGFydGlhbChcbiAgbmFtZTogQVNULlBhdGhFeHByZXNzaW9uLFxuICBwYXJhbXM/OiBBU1QuRXhwcmVzc2lvbltdLFxuICBoYXNoPzogQVNULkhhc2gsXG4gIGluZGVudD86IHN0cmluZyxcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuUGFydGlhbFN0YXRlbWVudCB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ1BhcnRpYWxTdGF0ZW1lbnQnLFxuICAgIG5hbWU6IG5hbWUsXG4gICAgcGFyYW1zOiBwYXJhbXMgfHwgW10sXG4gICAgaGFzaDogaGFzaCB8fCBidWlsZEhhc2goW10pLFxuICAgIGluZGVudDogaW5kZW50IHx8ICcnLFxuICAgIHN0cmlwOiB7IG9wZW46IGZhbHNlLCBjbG9zZTogZmFsc2UgfSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRDb21tZW50KHZhbHVlOiBzdHJpbmcsIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvbik6IEFTVC5Db21tZW50U3RhdGVtZW50IHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnQ29tbWVudFN0YXRlbWVudCcsXG4gICAgdmFsdWU6IHZhbHVlLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZE11c3RhY2hlQ29tbWVudChcbiAgdmFsdWU6IHN0cmluZyxcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuTXVzdGFjaGVDb21tZW50U3RhdGVtZW50IHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnTXVzdGFjaGVDb21tZW50U3RhdGVtZW50JyxcbiAgICB2YWx1ZTogdmFsdWUsXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkQ29uY2F0KFxuICBwYXJ0czogKEFTVC5UZXh0Tm9kZSB8IEFTVC5NdXN0YWNoZVN0YXRlbWVudClbXSxcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuQ29uY2F0U3RhdGVtZW50IHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnQ29uY2F0U3RhdGVtZW50JyxcbiAgICBwYXJ0czogcGFydHMgfHwgW10sXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbi8vIE5vZGVzXG5cbmZ1bmN0aW9uIGJ1aWxkRWxlbWVudChcbiAgdGFnOiBUYWdEZXNjcmlwdG9yLFxuICBhdHRyaWJ1dGVzPzogQVNULkF0dHJOb2RlW10sXG4gIG1vZGlmaWVycz86IEFTVC5FbGVtZW50TW9kaWZpZXJTdGF0ZW1lbnRbXSxcbiAgY2hpbGRyZW4/OiBBU1QuU3RhdGVtZW50W10sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULkVsZW1lbnROb2RlO1xuZnVuY3Rpb24gYnVpbGRFbGVtZW50KFxuICB0YWc6IFRhZ0Rlc2NyaXB0b3IsXG4gIGF0dHJpYnV0ZXM/OiBBU1QuQXR0ck5vZGVbXSxcbiAgbW9kaWZpZXJzPzogQVNULkVsZW1lbnRNb2RpZmllclN0YXRlbWVudFtdLFxuICBjaGlsZHJlbj86IEFTVC5TdGF0ZW1lbnRbXSxcbiAgY29tbWVudHM/OiBBU1QuTXVzdGFjaGVDb21tZW50U3RhdGVtZW50W10sXG4gIGJsb2NrUGFyYW1zPzogc3RyaW5nW10sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULkVsZW1lbnROb2RlO1xuXG5mdW5jdGlvbiBidWlsZEVsZW1lbnQoXG4gIHRhZzogVGFnRGVzY3JpcHRvcixcbiAgYXR0cmlidXRlcz86IEFTVC5BdHRyTm9kZVtdLFxuICBtb2RpZmllcnM/OiBBU1QuRWxlbWVudE1vZGlmaWVyU3RhdGVtZW50W10sXG4gIGNoaWxkcmVuPzogQVNULlN0YXRlbWVudFtdLFxuICBjb21tZW50cz86IEFTVC5NdXN0YWNoZUNvbW1lbnRTdGF0ZW1lbnRbXSB8IEFTVC5Tb3VyY2VMb2NhdGlvbiB8IHN0cmluZ1tdLFxuICBibG9ja1BhcmFtcz86IHN0cmluZ1tdLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5FbGVtZW50Tm9kZSB7XG4gIC8vIHRoaXMgaXMgdXNlZCBmb3IgYmFja3dhcmRzIGNvbXBhdCBwcmlvciB0byBgYmxvY2tQYXJhbXNgIGJlaW5nIGFkZGVkIHRvIHRoZSBBU1RcbiAgaWYgKEFycmF5LmlzQXJyYXkoY29tbWVudHMpKSB7XG4gICAgaWYgKGlzQmxvY2tQYXJtcyhjb21tZW50cykpIHtcbiAgICAgIGJsb2NrUGFyYW1zID0gY29tbWVudHM7XG4gICAgICBjb21tZW50cyA9IFtdO1xuICAgIH0gZWxzZSBpZiAoaXNMb2MoYmxvY2tQYXJhbXMpKSB7XG4gICAgICBsb2MgPSBibG9ja1BhcmFtcztcbiAgICAgIGJsb2NrUGFyYW1zID0gW107XG4gICAgfVxuICB9IGVsc2UgaWYgKGlzTG9jKGNvbW1lbnRzKSkge1xuICAgIC8vIHRoaXMgaXMgdXNlZCBmb3IgYmFja3dhcmRzIGNvbXBhdCBwcmlvciB0byBgY29tbWVudHNgIGJlaW5nIGFkZGVkIHRvIHRoZSBBU1RcbiAgICBsb2MgPSBjb21tZW50cztcbiAgICBjb21tZW50cyA9IFtdO1xuICB9IGVsc2UgaWYgKGlzTG9jKGJsb2NrUGFyYW1zKSkge1xuICAgIGxvYyA9IGJsb2NrUGFyYW1zO1xuICAgIGJsb2NrUGFyYW1zID0gW107XG4gIH1cblxuICAvLyB0aGlzIGlzIHVzZWQgZm9yIGJhY2t3YXJkcyBjb21wYXQsIHByaW9yIHRvIGBzZWxmQ2xvc2luZ2AgYmVpbmcgcGFydCBvZiB0aGUgRWxlbWVudE5vZGUgQVNUXG4gIGxldCBzZWxmQ2xvc2luZyA9IGZhbHNlO1xuICBpZiAodHlwZW9mIHRhZyA9PT0gJ29iamVjdCcpIHtcbiAgICBzZWxmQ2xvc2luZyA9IHRhZy5zZWxmQ2xvc2luZztcbiAgICB0YWcgPSB0YWcubmFtZTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0VsZW1lbnROb2RlJyxcbiAgICB0YWc6IHRhZyB8fCAnJyxcbiAgICBzZWxmQ2xvc2luZzogc2VsZkNsb3NpbmcsXG4gICAgYXR0cmlidXRlczogYXR0cmlidXRlcyB8fCBbXSxcbiAgICBibG9ja1BhcmFtczogYmxvY2tQYXJhbXMgfHwgW10sXG4gICAgbW9kaWZpZXJzOiBtb2RpZmllcnMgfHwgW10sXG4gICAgY29tbWVudHM6IChjb21tZW50cyBhcyBBU1QuTXVzdGFjaGVDb21tZW50U3RhdGVtZW50W10pIHx8IFtdLFxuICAgIGNoaWxkcmVuOiBjaGlsZHJlbiB8fCBbXSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRBdHRyKFxuICBuYW1lOiBzdHJpbmcsXG4gIHZhbHVlOiBBU1QuQXR0ck5vZGVbJ3ZhbHVlJ10sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULkF0dHJOb2RlIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnQXR0ck5vZGUnLFxuICAgIG5hbWU6IG5hbWUsXG4gICAgdmFsdWU6IHZhbHVlLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZFRleHQoY2hhcnM/OiBzdHJpbmcsIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvbik6IEFTVC5UZXh0Tm9kZSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ1RleHROb2RlJyxcbiAgICBjaGFyczogY2hhcnMgfHwgJycsXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbi8vIEV4cHJlc3Npb25zXG5cbmZ1bmN0aW9uIGJ1aWxkU2V4cHIoXG4gIHBhdGg6IEJ1aWxkZXJQYXRoLFxuICBwYXJhbXM/OiBBU1QuRXhwcmVzc2lvbltdLFxuICBoYXNoPzogQVNULkhhc2gsXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULlN1YkV4cHJlc3Npb24ge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdTdWJFeHByZXNzaW9uJyxcbiAgICBwYXRoOiBidWlsZFBhdGgocGF0aCksXG4gICAgcGFyYW1zOiBwYXJhbXMgfHwgW10sXG4gICAgaGFzaDogaGFzaCB8fCBidWlsZEhhc2goW10pLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZFBhdGgob3JpZ2luYWw6IEJ1aWxkZXJQYXRoLCBsb2M/OiBBU1QuU291cmNlTG9jYXRpb24pOiBBU1QuUGF0aEV4cHJlc3Npb24ge1xuICBpZiAodHlwZW9mIG9yaWdpbmFsICE9PSAnc3RyaW5nJykgcmV0dXJuIG9yaWdpbmFsO1xuXG4gIGxldCBwYXJ0cyA9IG9yaWdpbmFsLnNwbGl0KCcuJyk7XG4gIGxldCB0aGlzSGVhZCA9IGZhbHNlO1xuXG4gIGlmIChwYXJ0c1swXSA9PT0gJ3RoaXMnKSB7XG4gICAgdGhpc0hlYWQgPSB0cnVlO1xuICAgIHBhcnRzID0gcGFydHMuc2xpY2UoMSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHR5cGU6ICdQYXRoRXhwcmVzc2lvbicsXG4gICAgb3JpZ2luYWwsXG4gICAgdGhpczogdGhpc0hlYWQsXG4gICAgcGFydHMsXG4gICAgZGF0YTogZmFsc2UsXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkTGl0ZXJhbDxUIGV4dGVuZHMgQVNULkxpdGVyYWw+KFxuICB0eXBlOiBUWyd0eXBlJ10sXG4gIHZhbHVlOiBUWyd2YWx1ZSddLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5MaXRlcmFsIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlLFxuICAgIHZhbHVlLFxuICAgIG9yaWdpbmFsOiB2YWx1ZSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfSBhcyBBU1QuTGl0ZXJhbDtcbn1cblxuLy8gTWlzY2VsbGFuZW91c1xuXG5mdW5jdGlvbiBidWlsZEhhc2gocGFpcnM/OiBBU1QuSGFzaFBhaXJbXSwgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uKTogQVNULkhhc2gge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdIYXNoJyxcbiAgICBwYWlyczogcGFpcnMgfHwgW10sXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkUGFpcihrZXk6IHN0cmluZywgdmFsdWU6IEFTVC5FeHByZXNzaW9uLCBsb2M/OiBBU1QuU291cmNlTG9jYXRpb24pOiBBU1QuSGFzaFBhaXIge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdIYXNoUGFpcicsXG4gICAga2V5OiBrZXksXG4gICAgdmFsdWUsXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkUHJvZ3JhbShcbiAgYm9keT86IEFTVC5TdGF0ZW1lbnRbXSxcbiAgYmxvY2tQYXJhbXM/OiBzdHJpbmdbXSxcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuUHJvZ3JhbSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ1Byb2dyYW0nLFxuICAgIGJvZHk6IGJvZHkgfHwgW10sXG4gICAgYmxvY2tQYXJhbXM6IGJsb2NrUGFyYW1zIHx8IFtdLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZFNvdXJjZShzb3VyY2U/OiBzdHJpbmcpIHtcbiAgcmV0dXJuIHNvdXJjZSB8fCBudWxsO1xufVxuXG5mdW5jdGlvbiBidWlsZFBvc2l0aW9uKGxpbmU6IG51bWJlciwgY29sdW1uOiBudW1iZXIpIHtcbiAgcmV0dXJuIHtcbiAgICBsaW5lLFxuICAgIGNvbHVtbixcbiAgfTtcbn1cblxuZXhwb3J0IGNvbnN0IFNZTlRIRVRJQzogQVNULlNvdXJjZUxvY2F0aW9uID0ge1xuICBzb3VyY2U6ICcoc3ludGhldGljKScsXG4gIHN0YXJ0OiB7IGxpbmU6IDEsIGNvbHVtbjogMCB9LFxuICBlbmQ6IHsgbGluZTogMSwgY29sdW1uOiAwIH0sXG59O1xuXG5mdW5jdGlvbiBidWlsZExvYyhsb2M6IE9wdGlvbjxBU1QuU291cmNlTG9jYXRpb24+KTogQVNULlNvdXJjZUxvY2F0aW9uO1xuZnVuY3Rpb24gYnVpbGRMb2MoXG4gIHN0YXJ0TGluZTogbnVtYmVyLFxuICBzdGFydENvbHVtbjogbnVtYmVyLFxuICBlbmRMaW5lPzogbnVtYmVyLFxuICBlbmRDb2x1bW4/OiBudW1iZXIsXG4gIHNvdXJjZT86IHN0cmluZ1xuKTogQVNULlNvdXJjZUxvY2F0aW9uO1xuXG5mdW5jdGlvbiBidWlsZExvYyguLi5hcmdzOiBhbnlbXSk6IEFTVC5Tb3VyY2VMb2NhdGlvbiB7XG4gIGlmIChhcmdzLmxlbmd0aCA9PT0gMSkge1xuICAgIGxldCBsb2MgPSBhcmdzWzBdO1xuXG4gICAgaWYgKGxvYyAmJiB0eXBlb2YgbG9jID09PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc291cmNlOiBidWlsZFNvdXJjZShsb2Muc291cmNlKSxcbiAgICAgICAgc3RhcnQ6IGJ1aWxkUG9zaXRpb24obG9jLnN0YXJ0LmxpbmUsIGxvYy5zdGFydC5jb2x1bW4pLFxuICAgICAgICBlbmQ6IGJ1aWxkUG9zaXRpb24obG9jLmVuZC5saW5lLCBsb2MuZW5kLmNvbHVtbiksXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gU1lOVEhFVElDO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBsZXQgW3N0YXJ0TGluZSwgc3RhcnRDb2x1bW4sIGVuZExpbmUsIGVuZENvbHVtbiwgc291cmNlXSA9IGFyZ3M7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNvdXJjZTogYnVpbGRTb3VyY2Uoc291cmNlKSxcbiAgICAgIHN0YXJ0OiBidWlsZFBvc2l0aW9uKHN0YXJ0TGluZSwgc3RhcnRDb2x1bW4pLFxuICAgICAgZW5kOiBidWlsZFBvc2l0aW9uKGVuZExpbmUsIGVuZENvbHVtbiksXG4gICAgfTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpc0Jsb2NrUGFybXMoYXJyOiBzdHJpbmdbXSB8IEFTVC5NdXN0YWNoZUNvbW1lbnRTdGF0ZW1lbnRbXSk6IGFyciBpcyBzdHJpbmdbXSB7XG4gIHJldHVybiBhcnJbMF0gPT09ICdzdHJpbmcnO1xufVxuXG5mdW5jdGlvbiBpc0xvYyhcbiAgaXRlbTogc3RyaW5nW10gfCBBU1QuU291cmNlTG9jYXRpb24gfCBBU1QuTXVzdGFjaGVDb21tZW50U3RhdGVtZW50W10gfCB1bmRlZmluZWRcbik6IGl0ZW0gaXMgQVNULlNvdXJjZUxvY2F0aW9uIHtcbiAgcmV0dXJuICFBcnJheS5pc0FycmF5KGl0ZW0pO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG11c3RhY2hlOiBidWlsZE11c3RhY2hlLFxuICBibG9jazogYnVpbGRCbG9jayxcbiAgcGFydGlhbDogYnVpbGRQYXJ0aWFsLFxuICBjb21tZW50OiBidWlsZENvbW1lbnQsXG4gIG11c3RhY2hlQ29tbWVudDogYnVpbGRNdXN0YWNoZUNvbW1lbnQsXG4gIGVsZW1lbnQ6IGJ1aWxkRWxlbWVudCxcbiAgZWxlbWVudE1vZGlmaWVyOiBidWlsZEVsZW1lbnRNb2RpZmllcixcbiAgYXR0cjogYnVpbGRBdHRyLFxuICB0ZXh0OiBidWlsZFRleHQsXG4gIHNleHByOiBidWlsZFNleHByLFxuICBwYXRoOiBidWlsZFBhdGgsXG4gIGNvbmNhdDogYnVpbGRDb25jYXQsXG4gIGhhc2g6IGJ1aWxkSGFzaCxcbiAgcGFpcjogYnVpbGRQYWlyLFxuICBsaXRlcmFsOiBidWlsZExpdGVyYWwsXG4gIHByb2dyYW06IGJ1aWxkUHJvZ3JhbSxcbiAgbG9jOiBidWlsZExvYyxcbiAgcG9zOiBidWlsZFBvc2l0aW9uLFxuXG4gIHN0cmluZzogbGl0ZXJhbCgnU3RyaW5nTGl0ZXJhbCcpLFxuICBib29sZWFuOiBsaXRlcmFsKCdCb29sZWFuTGl0ZXJhbCcpLFxuICBudW1iZXI6IGxpdGVyYWwoJ051bWJlckxpdGVyYWwnKSxcbiAgdW5kZWZpbmVkKCkge1xuICAgIHJldHVybiBidWlsZExpdGVyYWwoJ1VuZGVmaW5lZExpdGVyYWwnLCB1bmRlZmluZWQpO1xuICB9LFxuICBudWxsKCkge1xuICAgIHJldHVybiBidWlsZExpdGVyYWwoJ051bGxMaXRlcmFsJywgbnVsbCk7XG4gIH0sXG59O1xuXG5mdW5jdGlvbiBsaXRlcmFsPFQgZXh0ZW5kcyBBU1QuTGl0ZXJhbD4odHlwZTogVFsndHlwZSddKSB7XG4gIHJldHVybiBmdW5jdGlvbih2YWx1ZTogVFsndmFsdWUnXSkge1xuICAgIHJldHVybiBidWlsZExpdGVyYWwodHlwZSwgdmFsdWUpO1xuICB9O1xufVxuIl19