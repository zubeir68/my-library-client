'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.THIS = undefined;

var _templateVisitor = require('./template-visitor');

var _templateVisitor2 = _interopRequireDefault(_templateVisitor);

var _javascriptCompiler = require('./javascript-compiler');

var _javascriptCompiler2 = _interopRequireDefault(_javascriptCompiler);

var _util = require('@glimmer/util');

var _syntax = require('@glimmer/syntax');

var _utils = require('./utils');

var _allocateSymbols = require('./allocate-symbols');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
        throw new TypeError("Cannot call a class as a function");
    }
}

function isTrustedValue(value) {
    return value.escaped !== undefined && !value.escaped;
}
var THIS = exports.THIS = 0;

var TemplateCompiler = function () {
    function TemplateCompiler() {
        _classCallCheck(this, TemplateCompiler);

        this.templateId = 0;
        this.templateIds = [];
        this.opcodes = [];
        this.includeMeta = false;
    }

    TemplateCompiler.compile = function compile(ast, options) {
        var templateVisitor = new _templateVisitor2.default();
        templateVisitor.visit(ast);
        var compiler = new TemplateCompiler();
        var opcodes = compiler.process(templateVisitor.actions);
        var symbols = new _allocateSymbols.SymbolAllocator(opcodes).process();
        return _javascriptCompiler2.default.process(symbols, ast['symbols'], options);
    };

    TemplateCompiler.prototype.process = function process(actions) {
        var _this = this;

        actions.forEach(function (_ref) {
            var name = _ref[0],
                args = _ref.slice(1);

            if (!_this[name]) {
                throw new Error('Unimplemented ' + name + ' on TemplateCompiler');
            }
            _this[name].apply(_this, args);
        });
        return this.opcodes;
    };

    TemplateCompiler.prototype.startProgram = function startProgram(_ref2) {
        var program = _ref2[0];

        this.opcode(['startProgram', program], program);
    };

    TemplateCompiler.prototype.endProgram = function endProgram() {
        this.opcode(['endProgram', null], null);
    };

    TemplateCompiler.prototype.startBlock = function startBlock(_ref3) {
        var program = _ref3[0];

        this.templateId++;
        this.opcode(['startBlock', program], program);
    };

    TemplateCompiler.prototype.endBlock = function endBlock() {
        this.templateIds.push(this.templateId - 1);
        this.opcode(['endBlock', null], null);
    };

    TemplateCompiler.prototype.text = function text(_ref4) {
        var action = _ref4[0];

        this.opcode(['text', action.chars], action);
    };

    TemplateCompiler.prototype.comment = function comment(_ref5) {
        var action = _ref5[0];

        this.opcode(['comment', action.value], action);
    };

    TemplateCompiler.prototype.openElement = function openElement(_ref6) {
        var action = _ref6[0];

        var attributes = action.attributes;
        var hasSplat = void 0;
        for (var i = 0; i < attributes.length; i++) {
            var attr = attributes[i];
            if (attr.name === '...attributes') {
                hasSplat = attr;
                break;
            }
        }
        if (isDynamicComponent(action)) {
            var head = void 0,
                rest = void 0;

            var _action$tag$split = action.tag.split('.');

            head = _action$tag$split[0];
            rest = _action$tag$split.slice(1);

            if (head === 'this') {
                head = 0;
            }
            this.opcode(['get', [head, rest]]);
            this.opcode(['openComponent', action], action);
        } else if (isComponent(action)) {
            this.opcode(['openComponent', action], action);
        } else if (hasSplat) {
            this.opcode(['openSplattedElement', action], action);
        } else {
            this.opcode(['openElement', action], action);
        }
        var typeAttr = null;
        var attrs = action.attributes;
        for (var _i = 0; _i < attrs.length; _i++) {
            if (attrs[_i].name === 'type') {
                typeAttr = attrs[_i];
                continue;
            }
            this.attribute([attrs[_i]]);
        }
        if (typeAttr) {
            this.attribute([typeAttr]);
        }
        this.opcode(['flushElement', action], null);
    };

    TemplateCompiler.prototype.closeElement = function closeElement(_ref7) {
        var action = _ref7[0];

        if (isDynamicComponent(action)) {
            this.opcode(['closeDynamicComponent', action], action);
        } else if (isComponent(action)) {
            this.opcode(['closeComponent', action], action);
        } else if (action.modifiers.length > 0) {
            for (var i = 0; i < action.modifiers.length; i++) {
                this.modifier([action.modifiers[i]]);
            }
            this.opcode(['closeElement', action], action);
        } else {
            this.opcode(['closeElement', action], action);
        }
    };

    TemplateCompiler.prototype.attribute = function attribute(_ref8) {
        var action = _ref8[0];
        var name = action.name,
            value = action.value;

        var namespace = (0, _utils.getAttrNamespace)(name);
        var isStatic = this.prepareAttributeValue(value);
        if (name.charAt(0) === '@') {
            // Arguments
            if (isStatic) {
                this.opcode(['staticArg', name], action);
            } else if (action.value.type === 'MustacheStatement') {
                this.opcode(['dynamicArg', name], action);
            } else {
                this.opcode(['dynamicArg', name], action);
            }
        } else {
            var isTrusting = isTrustedValue(value);
            if (isStatic && name === '...attributes') {
                this.opcode(['attrSplat', null], action);
            } else if (isStatic) {
                this.opcode(['staticAttr', [name, namespace]], action);
            } else if (isTrusting) {
                this.opcode(['trustingAttr', [name, namespace]], action);
            } else if (action.value.type === 'MustacheStatement') {
                this.opcode(['dynamicAttr', [name, null]], action);
            } else {
                this.opcode(['dynamicAttr', [name, namespace]], action);
            }
        }
    };

    TemplateCompiler.prototype.modifier = function modifier(_ref9) {
        var action = _ref9[0];

        assertIsSimplePath(action.path, action.loc, 'modifier');
        var parts = action.path.parts;

        this.prepareHelper(action);
        this.opcode(['modifier', parts[0]], action);
    };

    TemplateCompiler.prototype.mustache = function mustache(_ref10) {
        var action = _ref10[0];
        var path = action.path;

        if ((0, _syntax.isLiteral)(path)) {
            this.mustacheExpression(action);
            this.opcode(['append', !action.escaped], action);
        } else if (isYield(path)) {
            var to = assertValidYield(action);
            this.yield(to, action);
        } else if (isPartial(path)) {
            var params = assertValidPartial(action);
            this.partial(params, action);
        } else if (isDebugger(path)) {
            assertValidDebuggerUsage(action);
            this.debugger('debugger', action);
        } else {
            this.mustacheExpression(action);
            this.opcode(['append', !action.escaped], action);
        }
    };

    TemplateCompiler.prototype.block = function block(_ref11) {
        var action /*, index, count*/ = _ref11[0];

        this.prepareHelper(action);
        var templateId = this.templateIds.pop();
        var inverseId = action.inverse === null ? null : this.templateIds.pop();
        this.opcode(['block', [action.path.parts[0], templateId, inverseId]], action);
    };
    /// Internal actions, not found in the original processed actions


    TemplateCompiler.prototype.arg = function arg(_ref12) {
        var path = _ref12[0];

        var _path$parts = path.parts,
            head = _path$parts[0],
            rest = _path$parts.slice(1);

        this.opcode(['get', ['@' + head, rest]], path);
    };

    TemplateCompiler.prototype.mustacheExpression = function mustacheExpression(expr) {
        var path = expr.path;

        if ((0, _syntax.isLiteral)(path)) {
            this.opcode(['literal', path.value], expr);
        } else if (isBuiltInHelper(path)) {
            this.builtInHelper(expr);
        } else if (isArg(path)) {
            this.arg([path]);
        } else if (isHelperInvocation(expr)) {
            this.prepareHelper(expr);
            this.opcode(['helper', path.parts[0]], expr);
        } else if (path.this) {
            this.opcode(['get', [0, path.parts]], expr);
        } else {
            var _path$parts2 = path.parts,
                head = _path$parts2[0],
                parts = _path$parts2.slice(1);

            this.opcode(['maybeGet', [head, parts]], expr);
        }
        // } else if (isLocal(path, this.symbols)) {
        //   let [head, ...parts] = path.parts;
        //   this.opcode(['get', [head, parts]], expr);
        // } else if (isSimplePath(path)) {
        //   this.opcode(['unknown', path.parts[0]], expr);
        // } else {
        //   this.opcode(['maybeLocal', path.parts], expr);
        // }
    };
    /// Internal Syntax


    TemplateCompiler.prototype.yield = function _yield(to, action) {
        this.prepareParams(action.params);
        this.opcode(['yield', to], action);
    };

    TemplateCompiler.prototype.debugger = function _debugger(_name, action) {
        this.opcode(['debugger', null], action);
    };

    TemplateCompiler.prototype.hasBlock = function hasBlock(name, action) {
        this.opcode(['hasBlock', name], action);
    };

    TemplateCompiler.prototype.hasBlockParams = function hasBlockParams(name, action) {
        this.opcode(['hasBlockParams', name], action);
    };

    TemplateCompiler.prototype.partial = function partial(_params, action) {
        this.prepareParams(action.params);
        this.opcode(['partial', null], action);
    };

    TemplateCompiler.prototype.builtInHelper = function builtInHelper(expr) {
        var path = expr.path;

        if (isHasBlock(path)) {
            var name = assertValidHasBlockUsage(expr.path.original, expr);
            this.hasBlock(name, expr);
        } else if (isHasBlockParams(path)) {
            var _name2 = assertValidHasBlockUsage(expr.path.original, expr);
            this.hasBlockParams(_name2, expr);
        }
    };
    /// Expressions, invoked recursively from prepareParams and prepareHash


    TemplateCompiler.prototype.SubExpression = function SubExpression(expr) {
        if (isBuiltInHelper(expr.path)) {
            this.builtInHelper(expr);
        } else {
            this.prepareHelper(expr);
            this.opcode(['helper', expr.path.parts[0]], expr);
        }
    };

    TemplateCompiler.prototype.PathExpression = function PathExpression(expr) {
        if (expr.data) {
            this.arg([expr]);
        } else {
            var _expr$parts = expr.parts,
                head = _expr$parts[0],
                rest = _expr$parts.slice(1);

            if (expr.this) {
                this.opcode(['get', [0, expr.parts]], expr);
            } else {
                this.opcode(['get', [head, rest]], expr);
            }
        }
    };

    TemplateCompiler.prototype.StringLiteral = function StringLiteral(action) {
        this.opcode(['literal', action.value], action);
    };

    TemplateCompiler.prototype.BooleanLiteral = function BooleanLiteral(action) {
        this.opcode(['literal', action.value], action);
    };

    TemplateCompiler.prototype.NumberLiteral = function NumberLiteral(action) {
        this.opcode(['literal', action.value], action);
    };

    TemplateCompiler.prototype.NullLiteral = function NullLiteral(action) {
        this.opcode(['literal', action.value], action);
    };

    TemplateCompiler.prototype.UndefinedLiteral = function UndefinedLiteral(action) {
        this.opcode(['literal', action.value], action);
    };
    /// Utilities


    TemplateCompiler.prototype.opcode = function opcode(_opcode) {
        var action = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

        // TODO: This doesn't really work
        if (this.includeMeta && action) {
            _opcode.push(this.meta(action));
        }
        this.opcodes.push(_opcode);
    };

    TemplateCompiler.prototype.prepareHelper = function prepareHelper(expr) {
        assertIsSimplePath(expr.path, expr.loc, 'helper');
        var params = expr.params,
            hash = expr.hash;

        this.prepareHash(hash);
        this.prepareParams(params);
    };

    TemplateCompiler.prototype.prepareParams = function prepareParams(params) {
        if (!params.length) {
            this.opcode(['literal', null], null);
            return;
        }
        for (var i = params.length - 1; i >= 0; i--) {
            var param = params[i];
            false && (0, _util.assert)(this[param.type], 'Unimplemented ' + param.type + ' on TemplateCompiler');

            this[param.type](param);
        }
        this.opcode(['prepareArray', params.length], null);
    };

    TemplateCompiler.prototype.prepareHash = function prepareHash(hash) {
        var pairs = hash.pairs;
        if (!pairs.length) {
            this.opcode(['literal', null], null);
            return;
        }
        for (var i = pairs.length - 1; i >= 0; i--) {
            var _pairs$i = pairs[i],
                key = _pairs$i.key,
                value = _pairs$i.value;

            false && (0, _util.assert)(this[value.type], 'Unimplemented ' + value.type + ' on TemplateCompiler');

            this[value.type](value);
            this.opcode(['literal', key], null);
        }
        this.opcode(['prepareObject', pairs.length], null);
    };

    TemplateCompiler.prototype.prepareAttributeValue = function prepareAttributeValue(value) {
        // returns the static value if the value is static
        switch (value.type) {
            case 'TextNode':
                this.opcode(['literal', value.chars], value);
                return true;
            case 'MustacheStatement':
                this.attributeMustache([value]);
                return false;
            case 'ConcatStatement':
                this.prepareConcatParts(value.parts);
                this.opcode(['concat', null], value);
                return false;
        }
    };

    TemplateCompiler.prototype.prepareConcatParts = function prepareConcatParts(parts) {
        for (var i = parts.length - 1; i >= 0; i--) {
            var part = parts[i];
            if (part.type === 'MustacheStatement') {
                this.attributeMustache([part]);
            } else if (part.type === 'TextNode') {
                this.opcode(['literal', part.chars], null);
            }
        }
        this.opcode(['prepareArray', parts.length], null);
    };

    TemplateCompiler.prototype.attributeMustache = function attributeMustache(_ref13) {
        var action = _ref13[0];

        this.mustacheExpression(action);
    };

    TemplateCompiler.prototype.meta = function meta(node) {
        var loc = node.loc;
        if (!loc) {
            return [];
        }
        var source = loc.source,
            start = loc.start,
            end = loc.end;

        return ['loc', [source || null, [start.line, start.column], [end.line, end.column]]];
    };

    return TemplateCompiler;
}();

exports.default = TemplateCompiler;


function isHelperInvocation(mustache) {
    return mustache.params && mustache.params.length > 0 || mustache.hash && mustache.hash.pairs.length > 0;
}
function isSimplePath(_ref14) {
    var parts = _ref14.parts;

    return parts.length === 1;
}
function isYield(path) {
    return path.original === 'yield';
}
function isPartial(path) {
    return path.original === 'partial';
}
function isDebugger(path) {
    return path.original === 'debugger';
}
function isHasBlock(path) {
    return path.original === 'has-block';
}
function isHasBlockParams(path) {
    return path.original === 'has-block-params';
}
function isBuiltInHelper(path) {
    return isHasBlock(path) || isHasBlockParams(path);
}
function isArg(path) {
    return !!path['data'];
}
function isDynamicComponent(element) {
    var open = element.tag.charAt(0);

    var _element$tag$split = element.tag.split('.'),
        maybeLocal = _element$tag$split[0];

    var isNamedArgument = open === '@';
    var isLocal = element['symbols'].has(maybeLocal);
    var isThisPath = element.tag.indexOf('this.') === 0;
    return isLocal || isNamedArgument || isThisPath;
}
function isComponent(element) {
    var open = element.tag.charAt(0);
    var isPath = element.tag.indexOf('.') > -1;
    var isUpperCase = open === open.toUpperCase() && open !== open.toLowerCase();
    return isUpperCase && !isPath || isDynamicComponent(element);
}
function assertIsSimplePath(path, loc, context) {
    if (!isSimplePath(path)) {
        throw new _syntax.SyntaxError('`' + path.original + '` is not a valid name for a ' + context + ' on line ' + loc.start.line + '.', path.loc);
    }
}
function assertValidYield(statement) {
    var pairs = statement.hash.pairs;

    if (pairs.length === 1 && pairs[0].key !== 'to' || pairs.length > 1) {
        throw new _syntax.SyntaxError('yield only takes a single named argument: \'to\'', statement.loc);
    } else if (pairs.length === 1 && pairs[0].value.type !== 'StringLiteral') {
        throw new _syntax.SyntaxError('you can only yield to a literal value', statement.loc);
    } else if (pairs.length === 0) {
        return 'default';
    } else {
        return pairs[0].value.value;
    }
}
function assertValidPartial(statement) {
    var params = statement.params,
        hash = statement.hash,
        escaped = statement.escaped,
        loc = statement.loc;

    if (params && params.length !== 1) {
        throw new _syntax.SyntaxError('Partial found with no arguments. You must specify a template name. (on line ' + loc.start.line + ')', statement.loc);
    } else if (hash && hash.pairs.length > 0) {
        throw new _syntax.SyntaxError('partial does not take any named arguments (on line ' + loc.start.line + ')', statement.loc);
    } else if (!escaped) {
        throw new _syntax.SyntaxError('{{{partial ...}}} is not supported, please use {{partial ...}} instead (on line ' + loc.start.line + ')', statement.loc);
    }
    return params;
}
function assertValidHasBlockUsage(type, call) {
    var params = call.params,
        hash = call.hash,
        loc = call.loc;

    if (hash && hash.pairs.length > 0) {
        throw new _syntax.SyntaxError(type + ' does not take any named arguments', call.loc);
    }
    if (params.length === 0) {
        return 'default';
    } else if (params.length === 1) {
        var param = params[0];
        if (param.type === 'StringLiteral') {
            return param.value;
        } else {
            throw new _syntax.SyntaxError('you can only yield to a literal value (on line ' + loc.start.line + ')', call.loc);
        }
    } else {
        throw new _syntax.SyntaxError(type + ' only takes a single positional argument (on line ' + loc.start.line + ')', call.loc);
    }
}
function assertValidDebuggerUsage(statement) {
    var params = statement.params,
        hash = statement.hash;

    if (hash && hash.pairs.length > 0) {
        throw new _syntax.SyntaxError('debugger does not take any named arguments', statement.loc);
    }
    if (params.length === 0) {
        return 'default';
    } else {
        throw new _syntax.SyntaxError('debugger does not take any positional arguments', statement.loc);
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVtcGxhdGUtY29tcGlsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9jb21waWxlci9saWIvdGVtcGxhdGUtY29tcGlsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLEFBQU8sQUFBMkIsQUFBTSxBQUFvQixBQUFDOzs7O0FBQzdELEFBQU8sQUFBZ0MsQUFBTSxBQUF1QixBQUFDOzs7O0FBQ3JFLEFBQU8sQUFBRSxBQUFNLEFBQVUsQUFBTSxBQUFlLEFBQUM7O0FBQy9DLEFBQU8sQUFBTyxBQUFTLEFBQUUsQUFBVyxBQUFFLEFBQU0sQUFBaUIsQUFBQzs7QUFDOUQsQUFBTyxBQUFFLEFBQWdCLEFBQUUsQUFBTSxBQUFTLEFBQUM7O0FBRTNDLEFBQU8sQUFBRSxBQUFlLEFBQTRDLEFBQU0sQUFBb0IsQUFBQzs7Ozs7Ozs7OztBQVEvRix3QkFBd0IsQUFBVSxPQUNoQztXQUFPLEFBQUssTUFBQyxBQUFPLFlBQUssQUFBUyxhQUFJLENBQUMsQUFBSyxNQUFDLEFBQU8sQUFBQyxBQUN2RCxBQUFDO0FBRUQsQUFBTTtBQUFDLElBQU0sQUFBSSxzQkFBRyxBQUFDLEFBQUMsQUFFdEIsQUFBTSxBQUFDLEFBQU87O0lBQWQ7Z0NBWVU7OzthQUFVLGFBQUcsQUFBQyxBQUFDLEFBQ2Y7YUFBVyxjQUFhLEFBQUUsQUFBQyxBQUMzQjthQUFPLFVBQWlCLEFBQUUsQUFBQyxBQUMzQjthQUFXLGNBQUcsQUFBSyxBQUFDLEFBbVk5QixBQUFDLEFBalpDLEFBQU07OztxQkFBQyxBQUFPLDJCQUFDLEFBQWdCLEtBQUUsQUFBd0IsU0FDdkQ7WUFBSSxBQUFlLGtCQUFHLEFBQUksQUFBZSxBQUFFLEFBQUMsQUFDNUMsQUFBZTt3QkFBQyxBQUFLLE1BQUMsQUFBRyxBQUFDLEFBQUMsQUFFM0I7WUFBSSxBQUFRLFdBQUcsSUFBSSxBQUFnQixBQUFFLEFBQUMsQUFDdEM7WUFBSSxBQUFPLFVB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QUFNLE9BQUMsQUFBTSxXQUFLLEFBQUMsR0FBRSxBQUN2QjtlQUFPLEFBQVMsQUFBQyxBQUNsQjtlQUFVLEFBQU0sT0FBQyxBQUFNLFdBQUssQUFBQyxHQUFFLEFBQzlCO1lBQUksQUFBSyxRQUFHLEFBQU0sT0FBQyxBQUFDLEFBQUMsQUFBQyxBQUN0QjtZQUFJLEFBQUssTUFBQyxBQUFJLFNBQUssQUFBZSxpQkFBRSxBQUNsQzttQkFBTyxBQUFLLE1BQUMsQUFBSyxBQUFDLEFBQ3BCO2VBQU0sQUFDTDtrQkFBTSxBQUFJLEFBQVcsQUFDbkIsNEVBQWtELEFBQUcsSUFBQyxBQUFLLE1BQUMsQUFBSSxBQUFHLFlBQ25FLEFBQUksS0FBQyxBQUFHLEFBQ1QsQUFBQyxBQUNILEFBQ0Y7QUFWTTtXQVVBLEFBQ0w7Y0FBTSxBQUFJLEFBQVcsQUFDbkIsd0JBQUcsQUFBSSw4REFBcUQsQUFBRyxJQUFDLEFBQUssTUFBQyxBQUFJLEFBQUcsWUFDN0UsQUFBSSxLQUFDLEFBQUcsQUFDVCxBQUFDLEFBQ0gsQUFDSCxBQUFDOzs7QUFFRCxrQ0FBa0MsQUFBZ0MsV0FDaEUsQUFBSTtRQUFFLEFBQU07UUFBRSxBQUFJLEFBQUUsT0FBRyxBQUFTLEFBQUMsQUFFakM7O1FBQUksQUFBSSxRQUFJLEFBQUksS0FBQyxBQUFLLE1BQUMsQUFBTSxTQUFHLEFBQUMsR0FBRSxBQUNqQztjQUFNLEFBQUksQUFBVyxBQUFDLEFBQTRDLHNFQUFFLEFBQVMsVUFBQyxBQUFHLEFBQUMsQUFBQyxBQUNwRixBQUVEOztRQUFJLEFBQU0sT0FBQyxBQUFNLFdBQUssQUFBQyxHQUFFLEFBQ3ZCO2VBQU8sQUFBUyxBQUFDLEFBQ2xCO1dBQU0sQUFDTDtjQUFNLEFBQUksQUFBVyxBQUFDLEFBQWlELDJFQUFFLEFBQVMsVUFBQyxBQUFHLEFBQUMsQUFBQyxBQUN6RixBQUNILEFBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVGVtcGxhdGVWaXNpdG9yLCB7IEFjdGlvbiB9IGZyb20gJy4vdGVtcGxhdGUtdmlzaXRvcic7XG5pbXBvcnQgSmF2YVNjcmlwdENvbXBpbGVyLCB7IFRlbXBsYXRlIH0gZnJvbSAnLi9qYXZhc2NyaXB0LWNvbXBpbGVyJztcbmltcG9ydCB7IGFzc2VydCwgT3B0aW9uIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5pbXBvcnQgeyBBU1QsIGlzTGl0ZXJhbCwgU3ludGF4RXJyb3IgfSBmcm9tICdAZ2xpbW1lci9zeW50YXgnO1xuaW1wb3J0IHsgZ2V0QXR0ck5hbWVzcGFjZSB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgT3BhcXVlIH0gZnJvbSAnQGdsaW1tZXIvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBTeW1ib2xBbGxvY2F0b3IsIEluT3AgYXMgU3ltYm9sSW5PcCwgT3V0T3AgYXMgU3ltYm9sT3V0T3AgfSBmcm9tICcuL2FsbG9jYXRlLXN5bWJvbHMnO1xuaW1wb3J0IHsgUGF0aEhlYWQgfSBmcm9tICcuL2NvbXBpbGVyLW9wcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcGlsZU9wdGlvbnMge1xuICBtZXRhOiBPcGFxdWU7XG4gIGN1c3RvbWl6ZUNvbXBvbmVudE5hbWU/KHRhZzogc3RyaW5nKTogc3RyaW5nO1xufVxuXG5mdW5jdGlvbiBpc1RydXN0ZWRWYWx1ZSh2YWx1ZTogYW55KSB7XG4gIHJldHVybiB2YWx1ZS5lc2NhcGVkICE9PSB1bmRlZmluZWQgJiYgIXZhbHVlLmVzY2FwZWQ7XG59XG5cbmV4cG9ydCBjb25zdCBUSElTID0gMDtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGVtcGxhdGVDb21waWxlciB7XG4gIHN0YXRpYyBjb21waWxlKGFzdDogQVNULlByb2dyYW0sIG9wdGlvbnM/OiBDb21waWxlT3B0aW9ucyk6IFRlbXBsYXRlIHtcbiAgICBsZXQgdGVtcGxhdGVWaXNpdG9yID0gbmV3IFRlbXBsYXRlVmlzaXRvcigpO1xuICAgIHRlbXBsYXRlVmlzaXRvci52aXNpdChhc3QpO1xuXG4gICAgbGV0IGNvbXBpbGVyID0gbmV3IFRlbXBsYXRlQ29tcGlsZXIoKTtcbiAgICBsZXQgb3Bjb2RlczogU3ltYm9sSW5PcFtdID0gY29tcGlsZXIucHJvY2Vzcyh0ZW1wbGF0ZVZpc2l0b3IuYWN0aW9ucyk7XG4gICAgbGV0IHN5bWJvbHM6IFN5bWJvbE91dE9wW10gPSBuZXcgU3ltYm9sQWxsb2NhdG9yKG9wY29kZXMpLnByb2Nlc3MoKTtcblxuICAgIHJldHVybiBKYXZhU2NyaXB0Q29tcGlsZXIucHJvY2VzcyhzeW1ib2xzLCBhc3RbJ3N5bWJvbHMnXSwgb3B0aW9ucyk7XG4gIH1cblxuICBwcml2YXRlIHRlbXBsYXRlSWQgPSAwO1xuICBwcml2YXRlIHRlbXBsYXRlSWRzOiBudW1iZXJbXSA9IFtdO1xuICBwcml2YXRlIG9wY29kZXM6IFN5bWJvbEluT3BbXSA9IFtdO1xuICBwcml2YXRlIGluY2x1ZGVNZXRhID0gZmFsc2U7XG5cbiAgcHJvY2VzcyhhY3Rpb25zOiBBY3Rpb25bXSk6IFN5bWJvbEluT3BbXSB7XG4gICAgYWN0aW9ucy5mb3JFYWNoKChbbmFtZSwgLi4uYXJnc10pID0+IHtcbiAgICAgIGlmICghdGhpc1tuYW1lXSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuaW1wbGVtZW50ZWQgJHtuYW1lfSBvbiBUZW1wbGF0ZUNvbXBpbGVyYCk7XG4gICAgICB9XG4gICAgICAodGhpc1tuYW1lXSBhcyBhbnkpKC4uLmFyZ3MpO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLm9wY29kZXM7XG4gIH1cblxuICBzdGFydFByb2dyYW0oW3Byb2dyYW1dOiBbQVNULlByb2dyYW1dKSB7XG4gICAgdGhpcy5vcGNvZGUoWydzdGFydFByb2dyYW0nLCBwcm9ncmFtXSwgcHJvZ3JhbSk7XG4gIH1cblxuICBlbmRQcm9ncmFtKCkge1xuICAgIHRoaXMub3Bjb2RlKFsnZW5kUHJvZ3JhbScsIG51bGxdLCBudWxsKTtcbiAgfVxuXG4gIHN0YXJ0QmxvY2soW3Byb2dyYW1dOiBbQVNULlByb2dyYW1dKSB7XG4gICAgdGhpcy50ZW1wbGF0ZUlkKys7XG4gICAgdGhpcy5vcGNvZGUoWydzdGFydEJsb2NrJywgcHJvZ3JhbV0sIHByb2dyYW0pO1xuICB9XG5cbiAgZW5kQmxvY2soKSB7XG4gICAgdGhpcy50ZW1wbGF0ZUlkcy5wdXNoKHRoaXMudGVtcGxhdGVJZCAtIDEpO1xuICAgIHRoaXMub3Bjb2RlKFsnZW5kQmxvY2snLCBudWxsXSwgbnVsbCk7XG4gIH1cblxuICB0ZXh0KFthY3Rpb25dOiBbQVNULlRleHROb2RlXSkge1xuICAgIHRoaXMub3Bjb2RlKFsndGV4dCcsIGFjdGlvbi5jaGFyc10sIGFjdGlvbik7XG4gIH1cblxuICBjb21tZW50KFthY3Rpb25dOiBbQVNULkNvbW1lbnRTdGF0ZW1lbnRdKSB7XG4gICAgdGhpcy5vcGNvZGUoWydjb21tZW50JywgYWN0aW9uLnZhbHVlXSwgYWN0aW9uKTtcbiAgfVxuXG4gIG9wZW5FbGVtZW50KFthY3Rpb25dOiBbQVNULkVsZW1lbnROb2RlXSkge1xuICAgIGxldCBhdHRyaWJ1dGVzID0gYWN0aW9uLmF0dHJpYnV0ZXM7XG4gICAgbGV0IGhhc1NwbGF0O1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgYXR0ciA9IGF0dHJpYnV0ZXNbaV07XG4gICAgICBpZiAoYXR0ci5uYW1lID09PSAnLi4uYXR0cmlidXRlcycpIHtcbiAgICAgICAgaGFzU3BsYXQgPSBhdHRyO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoaXNEeW5hbWljQ29tcG9uZW50KGFjdGlvbikpIHtcbiAgICAgIGxldCBoZWFkOiBQYXRoSGVhZCwgcmVzdDogc3RyaW5nW107XG4gICAgICBbaGVhZCwgLi4ucmVzdF0gPSBhY3Rpb24udGFnLnNwbGl0KCcuJyk7XG4gICAgICBpZiAoaGVhZCA9PT0gJ3RoaXMnKSB7XG4gICAgICAgIGhlYWQgPSAwO1xuICAgICAgfVxuICAgICAgdGhpcy5vcGNvZGUoWydnZXQnLCBbaGVhZCwgcmVzdF1dKTtcbiAgICAgIHRoaXMub3Bjb2RlKFsnb3BlbkNvbXBvbmVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgfSBlbHNlIGlmIChpc0NvbXBvbmVudChhY3Rpb24pKSB7XG4gICAgICB0aGlzLm9wY29kZShbJ29wZW5Db21wb25lbnQnLCBhY3Rpb25dLCBhY3Rpb24pO1xuICAgIH0gZWxzZSBpZiAoaGFzU3BsYXQpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnb3BlblNwbGF0dGVkRWxlbWVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnb3BlbkVsZW1lbnQnLCBhY3Rpb25dLCBhY3Rpb24pO1xuICAgIH1cblxuICAgIGxldCB0eXBlQXR0cjogT3B0aW9uPEFTVC5BdHRyTm9kZT4gPSBudWxsO1xuICAgIGxldCBhdHRycyA9IGFjdGlvbi5hdHRyaWJ1dGVzO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXR0cnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChhdHRyc1tpXS5uYW1lID09PSAndHlwZScpIHtcbiAgICAgICAgdHlwZUF0dHIgPSBhdHRyc1tpXTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICB0aGlzLmF0dHJpYnV0ZShbYXR0cnNbaV1dKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZUF0dHIpIHtcbiAgICAgIHRoaXMuYXR0cmlidXRlKFt0eXBlQXR0cl0pO1xuICAgIH1cblxuICAgIHRoaXMub3Bjb2RlKFsnZmx1c2hFbGVtZW50JywgYWN0aW9uXSwgbnVsbCk7XG4gIH1cblxuICBjbG9zZUVsZW1lbnQoW2FjdGlvbl06IFtBU1QuRWxlbWVudE5vZGVdKSB7XG4gICAgaWYgKGlzRHluYW1pY0NvbXBvbmVudChhY3Rpb24pKSB7XG4gICAgICB0aGlzLm9wY29kZShbJ2Nsb3NlRHluYW1pY0NvbXBvbmVudCcsIGFjdGlvbl0sIGFjdGlvbik7XG4gICAgfSBlbHNlIGlmIChpc0NvbXBvbmVudChhY3Rpb24pKSB7XG4gICAgICB0aGlzLm9wY29kZShbJ2Nsb3NlQ29tcG9uZW50JywgYWN0aW9uXSwgYWN0aW9uKTtcbiAgICB9IGVsc2UgaWYgKGFjdGlvbi5tb2RpZmllcnMubGVuZ3RoID4gMCkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhY3Rpb24ubW9kaWZpZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMubW9kaWZpZXIoW2FjdGlvbi5tb2RpZmllcnNbaV1dKTtcbiAgICAgIH1cbiAgICAgIHRoaXMub3Bjb2RlKFsnY2xvc2VFbGVtZW50JywgYWN0aW9uXSwgYWN0aW9uKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5vcGNvZGUoWydjbG9zZUVsZW1lbnQnLCBhY3Rpb25dLCBhY3Rpb24pO1xuICAgIH1cbiAgfVxuXG4gIGF0dHJpYnV0ZShbYWN0aW9uXTogW0FTVC5BdHRyTm9kZV0pIHtcbiAgICBsZXQgeyBuYW1lLCB2YWx1ZSB9ID0gYWN0aW9uO1xuXG4gICAgbGV0IG5hbWVzcGFjZSA9IGdldEF0dHJOYW1lc3BhY2UobmFtZSk7XG5cbiAgICBsZXQgaXNTdGF0aWMgPSB0aGlzLnByZXBhcmVBdHRyaWJ1dGVWYWx1ZSh2YWx1ZSk7XG5cbiAgICBpZiAobmFtZS5jaGFyQXQoMCkgPT09ICdAJykge1xuICAgICAgLy8gQXJndW1lbnRzXG4gICAgICBpZiAoaXNTdGF0aWMpIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydzdGF0aWNBcmcnLCBuYW1lXSwgYWN0aW9uKTtcbiAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLnZhbHVlLnR5cGUgPT09ICdNdXN0YWNoZVN0YXRlbWVudCcpIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydkeW5hbWljQXJnJywgbmFtZV0sIGFjdGlvbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm9wY29kZShbJ2R5bmFtaWNBcmcnLCBuYW1lXSwgYWN0aW9uKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IGlzVHJ1c3RpbmcgPSBpc1RydXN0ZWRWYWx1ZSh2YWx1ZSk7XG5cbiAgICAgIGlmIChpc1N0YXRpYyAmJiBuYW1lID09PSAnLi4uYXR0cmlidXRlcycpIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydhdHRyU3BsYXQnLCBudWxsXSwgYWN0aW9uKTtcbiAgICAgIH0gZWxzZSBpZiAoaXNTdGF0aWMpIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydzdGF0aWNBdHRyJywgW25hbWUsIG5hbWVzcGFjZV1dLCBhY3Rpb24pO1xuICAgICAgfSBlbHNlIGlmIChpc1RydXN0aW5nKSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsndHJ1c3RpbmdBdHRyJywgW25hbWUsIG5hbWVzcGFjZV1dLCBhY3Rpb24pO1xuICAgICAgfSBlbHNlIGlmIChhY3Rpb24udmFsdWUudHlwZSA9PT0gJ011c3RhY2hlU3RhdGVtZW50Jykge1xuICAgICAgICB0aGlzLm9wY29kZShbJ2R5bmFtaWNBdHRyJywgW25hbWUsIG51bGxdXSwgYWN0aW9uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnZHluYW1pY0F0dHInLCBbbmFtZSwgbmFtZXNwYWNlXV0sIGFjdGlvbik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbW9kaWZpZXIoW2FjdGlvbl06IFtBU1QuRWxlbWVudE1vZGlmaWVyU3RhdGVtZW50XSkge1xuICAgIGFzc2VydElzU2ltcGxlUGF0aChhY3Rpb24ucGF0aCwgYWN0aW9uLmxvYywgJ21vZGlmaWVyJyk7XG5cbiAgICBsZXQge1xuICAgICAgcGF0aDogeyBwYXJ0cyB9LFxuICAgIH0gPSBhY3Rpb247XG5cbiAgICB0aGlzLnByZXBhcmVIZWxwZXIoYWN0aW9uKTtcbiAgICB0aGlzLm9wY29kZShbJ21vZGlmaWVyJywgcGFydHNbMF1dLCBhY3Rpb24pO1xuICB9XG5cbiAgbXVzdGFjaGUoW2FjdGlvbl06IFtBU1QuTXVzdGFjaGVTdGF0ZW1lbnRdKSB7XG4gICAgbGV0IHsgcGF0aCB9ID0gYWN0aW9uO1xuXG4gICAgaWYgKGlzTGl0ZXJhbChwYXRoKSkge1xuICAgICAgdGhpcy5tdXN0YWNoZUV4cHJlc3Npb24oYWN0aW9uKTtcbiAgICAgIHRoaXMub3Bjb2RlKFsnYXBwZW5kJywgIWFjdGlvbi5lc2NhcGVkXSwgYWN0aW9uKTtcbiAgICB9IGVsc2UgaWYgKGlzWWllbGQocGF0aCkpIHtcbiAgICAgIGxldCB0byA9IGFzc2VydFZhbGlkWWllbGQoYWN0aW9uKTtcbiAgICAgIHRoaXMueWllbGQodG8sIGFjdGlvbik7XG4gICAgfSBlbHNlIGlmIChpc1BhcnRpYWwocGF0aCkpIHtcbiAgICAgIGxldCBwYXJhbXMgPSBhc3NlcnRWYWxpZFBhcnRpYWwoYWN0aW9uKTtcbiAgICAgIHRoaXMucGFydGlhbChwYXJhbXMsIGFjdGlvbik7XG4gICAgfSBlbHNlIGlmIChpc0RlYnVnZ2VyKHBhdGgpKSB7XG4gICAgICBhc3NlcnRWYWxpZERlYnVnZ2VyVXNhZ2UoYWN0aW9uKTtcbiAgICAgIHRoaXMuZGVidWdnZXIoJ2RlYnVnZ2VyJywgYWN0aW9uKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5tdXN0YWNoZUV4cHJlc3Npb24oYWN0aW9uKTtcbiAgICAgIHRoaXMub3Bjb2RlKFsnYXBwZW5kJywgIWFjdGlvbi5lc2NhcGVkXSwgYWN0aW9uKTtcbiAgICB9XG4gIH1cblxuICBibG9jayhbYWN0aW9uIC8qLCBpbmRleCwgY291bnQqL106IFtBU1QuQmxvY2tTdGF0ZW1lbnRdKSB7XG4gICAgdGhpcy5wcmVwYXJlSGVscGVyKGFjdGlvbik7XG4gICAgbGV0IHRlbXBsYXRlSWQgPSB0aGlzLnRlbXBsYXRlSWRzLnBvcCgpITtcbiAgICBsZXQgaW52ZXJzZUlkID0gYWN0aW9uLmludmVyc2UgPT09IG51bGwgPyBudWxsIDogdGhpcy50ZW1wbGF0ZUlkcy5wb3AoKSE7XG4gICAgdGhpcy5vcGNvZGUoWydibG9jaycsIFthY3Rpb24ucGF0aC5wYXJ0c1swXSwgdGVtcGxhdGVJZCwgaW52ZXJzZUlkXV0sIGFjdGlvbik7XG4gIH1cblxuICAvLy8gSW50ZXJuYWwgYWN0aW9ucywgbm90IGZvdW5kIGluIHRoZSBvcmlnaW5hbCBwcm9jZXNzZWQgYWN0aW9uc1xuXG4gIGFyZyhbcGF0aF06IFtBU1QuUGF0aEV4cHJlc3Npb25dKSB7XG4gICAgbGV0IHtcbiAgICAgIHBhcnRzOiBbaGVhZCwgLi4ucmVzdF0sXG4gICAgfSA9IHBhdGg7XG4gICAgdGhpcy5vcGNvZGUoWydnZXQnLCBbYEAke2hlYWR9YCwgcmVzdF1dLCBwYXRoKTtcbiAgfVxuXG4gIG11c3RhY2hlRXhwcmVzc2lvbihleHByOiBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQpIHtcbiAgICBsZXQgeyBwYXRoIH0gPSBleHByO1xuXG4gICAgaWYgKGlzTGl0ZXJhbChwYXRoKSkge1xuICAgICAgdGhpcy5vcGNvZGUoWydsaXRlcmFsJywgcGF0aC52YWx1ZV0sIGV4cHIpO1xuICAgIH0gZWxzZSBpZiAoaXNCdWlsdEluSGVscGVyKHBhdGgpKSB7XG4gICAgICB0aGlzLmJ1aWx0SW5IZWxwZXIoZXhwciBhcyBBU1QuQ2FsbCk7XG4gICAgfSBlbHNlIGlmIChpc0FyZyhwYXRoKSkge1xuICAgICAgdGhpcy5hcmcoW3BhdGhdKTtcbiAgICB9IGVsc2UgaWYgKGlzSGVscGVySW52b2NhdGlvbihleHByKSkge1xuICAgICAgdGhpcy5wcmVwYXJlSGVscGVyKGV4cHIpO1xuICAgICAgdGhpcy5vcGNvZGUoWydoZWxwZXInLCBwYXRoLnBhcnRzWzBdXSwgZXhwcik7XG4gICAgfSBlbHNlIGlmIChwYXRoLnRoaXMpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnZ2V0JywgWzAsIHBhdGgucGFydHNdXSwgZXhwcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBbaGVhZCwgLi4ucGFydHNdID0gcGF0aC5wYXJ0cztcbiAgICAgIHRoaXMub3Bjb2RlKFsnbWF5YmVHZXQnLCBbaGVhZCwgcGFydHNdXSwgZXhwcik7XG4gICAgfVxuXG4gICAgLy8gfSBlbHNlIGlmIChpc0xvY2FsKHBhdGgsIHRoaXMuc3ltYm9scykpIHtcbiAgICAvLyAgIGxldCBbaGVhZCwgLi4ucGFydHNdID0gcGF0aC5wYXJ0cztcbiAgICAvLyAgIHRoaXMub3Bjb2RlKFsnZ2V0JywgW2hlYWQsIHBhcnRzXV0sIGV4cHIpO1xuICAgIC8vIH0gZWxzZSBpZiAoaXNTaW1wbGVQYXRoKHBhdGgpKSB7XG4gICAgLy8gICB0aGlzLm9wY29kZShbJ3Vua25vd24nLCBwYXRoLnBhcnRzWzBdXSwgZXhwcik7XG4gICAgLy8gfSBlbHNlIHtcbiAgICAvLyAgIHRoaXMub3Bjb2RlKFsnbWF5YmVMb2NhbCcsIHBhdGgucGFydHNdLCBleHByKTtcbiAgICAvLyB9XG4gIH1cblxuICAvLy8gSW50ZXJuYWwgU3ludGF4XG5cbiAgeWllbGQodG86IHN0cmluZywgYWN0aW9uOiBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQpIHtcbiAgICB0aGlzLnByZXBhcmVQYXJhbXMoYWN0aW9uLnBhcmFtcyk7XG4gICAgdGhpcy5vcGNvZGUoWyd5aWVsZCcsIHRvXSwgYWN0aW9uKTtcbiAgfVxuXG4gIGRlYnVnZ2VyKF9uYW1lOiBzdHJpbmcsIGFjdGlvbjogQVNULk11c3RhY2hlU3RhdGVtZW50KSB7XG4gICAgdGhpcy5vcGNvZGUoWydkZWJ1Z2dlcicsIG51bGxdLCBhY3Rpb24pO1xuICB9XG5cbiAgaGFzQmxvY2sobmFtZTogc3RyaW5nLCBhY3Rpb246IEFTVC5DYWxsKSB7XG4gICAgdGhpcy5vcGNvZGUoWydoYXNCbG9jaycsIG5hbWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgaGFzQmxvY2tQYXJhbXMobmFtZTogc3RyaW5nLCBhY3Rpb246IEFTVC5DYWxsKSB7XG4gICAgdGhpcy5vcGNvZGUoWydoYXNCbG9ja1BhcmFtcycsIG5hbWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgcGFydGlhbChfcGFyYW1zOiBBU1QuRXhwcmVzc2lvbltdLCBhY3Rpb246IEFTVC5NdXN0YWNoZVN0YXRlbWVudCkge1xuICAgIHRoaXMucHJlcGFyZVBhcmFtcyhhY3Rpb24ucGFyYW1zKTtcbiAgICB0aGlzLm9wY29kZShbJ3BhcnRpYWwnLCBudWxsXSwgYWN0aW9uKTtcbiAgfVxuXG4gIGJ1aWx0SW5IZWxwZXIoZXhwcjogQVNULkNhbGwpIHtcbiAgICBsZXQgeyBwYXRoIH0gPSBleHByO1xuICAgIGlmIChpc0hhc0Jsb2NrKHBhdGgpKSB7XG4gICAgICBsZXQgbmFtZSA9IGFzc2VydFZhbGlkSGFzQmxvY2tVc2FnZShleHByLnBhdGgub3JpZ2luYWwsIGV4cHIpO1xuICAgICAgdGhpcy5oYXNCbG9jayhuYW1lLCBleHByKTtcbiAgICB9IGVsc2UgaWYgKGlzSGFzQmxvY2tQYXJhbXMocGF0aCkpIHtcbiAgICAgIGxldCBuYW1lID0gYXNzZXJ0VmFsaWRIYXNCbG9ja1VzYWdlKGV4cHIucGF0aC5vcmlnaW5hbCwgZXhwcik7XG4gICAgICB0aGlzLmhhc0Jsb2NrUGFyYW1zKG5hbWUsIGV4cHIpO1xuICAgIH1cbiAgfVxuXG4gIC8vLyBFeHByZXNzaW9ucywgaW52b2tlZCByZWN1cnNpdmVseSBmcm9tIHByZXBhcmVQYXJhbXMgYW5kIHByZXBhcmVIYXNoXG5cbiAgU3ViRXhwcmVzc2lvbihleHByOiBBU1QuU3ViRXhwcmVzc2lvbikge1xuICAgIGlmIChpc0J1aWx0SW5IZWxwZXIoZXhwci5wYXRoKSkge1xuICAgICAgdGhpcy5idWlsdEluSGVscGVyKGV4cHIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnByZXBhcmVIZWxwZXIoZXhwcik7XG4gICAgICB0aGlzLm9wY29kZShbJ2hlbHBlcicsIGV4cHIucGF0aC5wYXJ0c1swXV0sIGV4cHIpO1xuICAgIH1cbiAgfVxuXG4gIFBhdGhFeHByZXNzaW9uKGV4cHI6IEFTVC5QYXRoRXhwcmVzc2lvbikge1xuICAgIGlmIChleHByLmRhdGEpIHtcbiAgICAgIHRoaXMuYXJnKFtleHByXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBbaGVhZCwgLi4ucmVzdF0gPSBleHByLnBhcnRzO1xuXG4gICAgICBpZiAoZXhwci50aGlzKSB7XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnZ2V0JywgWzAsIGV4cHIucGFydHNdXSwgZXhwcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm9wY29kZShbJ2dldCcsIFtoZWFkLCByZXN0XV0sIGV4cHIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIFN0cmluZ0xpdGVyYWwoYWN0aW9uOiBBU1QuU3RyaW5nTGl0ZXJhbCkge1xuICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIGFjdGlvbi52YWx1ZV0sIGFjdGlvbik7XG4gIH1cblxuICBCb29sZWFuTGl0ZXJhbChhY3Rpb246IEFTVC5Cb29sZWFuTGl0ZXJhbCkge1xuICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIGFjdGlvbi52YWx1ZV0sIGFjdGlvbik7XG4gIH1cblxuICBOdW1iZXJMaXRlcmFsKGFjdGlvbjogQVNULk51bWJlckxpdGVyYWwpIHtcbiAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBhY3Rpb24udmFsdWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgTnVsbExpdGVyYWwoYWN0aW9uOiBBU1QuTnVsbExpdGVyYWwpIHtcbiAgICB0aGlzLm9wY29kZShbJ2xpdGVyYWwnLCBhY3Rpb24udmFsdWVdLCBhY3Rpb24pO1xuICB9XG5cbiAgVW5kZWZpbmVkTGl0ZXJhbChhY3Rpb246IEFTVC5VbmRlZmluZWRMaXRlcmFsKSB7XG4gICAgdGhpcy5vcGNvZGUoWydsaXRlcmFsJywgYWN0aW9uLnZhbHVlXSwgYWN0aW9uKTtcbiAgfVxuXG4gIC8vLyBVdGlsaXRpZXNcblxuICBvcGNvZGU8TyBleHRlbmRzIFN5bWJvbEluT3A+KG9wY29kZTogTywgYWN0aW9uOiBPcHRpb248QVNULkJhc2VOb2RlPiA9IG51bGwpIHtcbiAgICAvLyBUT0RPOiBUaGlzIGRvZXNuJ3QgcmVhbGx5IHdvcmtcbiAgICBpZiAodGhpcy5pbmNsdWRlTWV0YSAmJiBhY3Rpb24pIHtcbiAgICAgIChvcGNvZGUgYXMgYW55KS5wdXNoKHRoaXMubWV0YShhY3Rpb24pKTtcbiAgICB9XG5cbiAgICB0aGlzLm9wY29kZXMucHVzaChvcGNvZGUpO1xuICB9XG5cbiAgcHJlcGFyZUhlbHBlcihleHByOiBBU1QuQ2FsbCkge1xuICAgIGFzc2VydElzU2ltcGxlUGF0aChleHByLnBhdGgsIGV4cHIubG9jLCAnaGVscGVyJyk7XG5cbiAgICBsZXQgeyBwYXJhbXMsIGhhc2ggfSA9IGV4cHI7XG5cbiAgICB0aGlzLnByZXBhcmVIYXNoKGhhc2gpO1xuICAgIHRoaXMucHJlcGFyZVBhcmFtcyhwYXJhbXMpO1xuICB9XG5cbiAgcHJlcGFyZVBhcmFtcyhwYXJhbXM6IEFTVC5FeHByZXNzaW9uW10pIHtcbiAgICBpZiAoIXBhcmFtcy5sZW5ndGgpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIG51bGxdLCBudWxsKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gcGFyYW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBsZXQgcGFyYW0gPSBwYXJhbXNbaV07XG5cbiAgICAgIGFzc2VydCh0aGlzW3BhcmFtLnR5cGVdLCBgVW5pbXBsZW1lbnRlZCAke3BhcmFtLnR5cGV9IG9uIFRlbXBsYXRlQ29tcGlsZXJgKTtcbiAgICAgICh0aGlzW3BhcmFtLnR5cGVdIGFzIGFueSkocGFyYW0pO1xuICAgIH1cblxuICAgIHRoaXMub3Bjb2RlKFsncHJlcGFyZUFycmF5JywgcGFyYW1zLmxlbmd0aF0sIG51bGwpO1xuICB9XG5cbiAgcHJlcGFyZUhhc2goaGFzaDogQVNULkhhc2gpIHtcbiAgICBsZXQgcGFpcnMgPSBoYXNoLnBhaXJzO1xuXG4gICAgaWYgKCFwYWlycy5sZW5ndGgpIHtcbiAgICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIG51bGxdLCBudWxsKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gcGFpcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGxldCB7IGtleSwgdmFsdWUgfSA9IHBhaXJzW2ldO1xuXG4gICAgICBhc3NlcnQodGhpc1t2YWx1ZS50eXBlXSwgYFVuaW1wbGVtZW50ZWQgJHt2YWx1ZS50eXBlfSBvbiBUZW1wbGF0ZUNvbXBpbGVyYCk7XG4gICAgICAodGhpc1t2YWx1ZS50eXBlXSBhcyBhbnkpKHZhbHVlKTtcbiAgICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIGtleV0sIG51bGwpO1xuICAgIH1cblxuICAgIHRoaXMub3Bjb2RlKFsncHJlcGFyZU9iamVjdCcsIHBhaXJzLmxlbmd0aF0sIG51bGwpO1xuICB9XG5cbiAgcHJlcGFyZUF0dHJpYnV0ZVZhbHVlKHZhbHVlOiBBU1QuQXR0ck5vZGVbJ3ZhbHVlJ10pIHtcbiAgICAvLyByZXR1cm5zIHRoZSBzdGF0aWMgdmFsdWUgaWYgdGhlIHZhbHVlIGlzIHN0YXRpY1xuXG4gICAgc3dpdGNoICh2YWx1ZS50eXBlKSB7XG4gICAgICBjYXNlICdUZXh0Tm9kZSc6XG4gICAgICAgIHRoaXMub3Bjb2RlKFsnbGl0ZXJhbCcsIHZhbHVlLmNoYXJzXSwgdmFsdWUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIGNhc2UgJ011c3RhY2hlU3RhdGVtZW50JzpcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVNdXN0YWNoZShbdmFsdWVdKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgY2FzZSAnQ29uY2F0U3RhdGVtZW50JzpcbiAgICAgICAgdGhpcy5wcmVwYXJlQ29uY2F0UGFydHModmFsdWUucGFydHMpO1xuICAgICAgICB0aGlzLm9wY29kZShbJ2NvbmNhdCcsIG51bGxdLCB2YWx1ZSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBwcmVwYXJlQ29uY2F0UGFydHMocGFydHM6IEFTVC5Db25jYXRTdGF0ZW1lbnRbJ3BhcnRzJ10pIHtcbiAgICBmb3IgKGxldCBpID0gcGFydHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGxldCBwYXJ0ID0gcGFydHNbaV07XG5cbiAgICAgIGlmIChwYXJ0LnR5cGUgPT09ICdNdXN0YWNoZVN0YXRlbWVudCcpIHtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVNdXN0YWNoZShbcGFydF0pO1xuICAgICAgfSBlbHNlIGlmIChwYXJ0LnR5cGUgPT09ICdUZXh0Tm9kZScpIHtcbiAgICAgICAgdGhpcy5vcGNvZGUoWydsaXRlcmFsJywgcGFydC5jaGFyc10sIG51bGwpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMub3Bjb2RlKFsncHJlcGFyZUFycmF5JywgcGFydHMubGVuZ3RoXSwgbnVsbCk7XG4gIH1cblxuICBhdHRyaWJ1dGVNdXN0YWNoZShbYWN0aW9uXTogW0FTVC5NdXN0YWNoZVN0YXRlbWVudF0pIHtcbiAgICB0aGlzLm11c3RhY2hlRXhwcmVzc2lvbihhY3Rpb24pO1xuICB9XG5cbiAgbWV0YShub2RlOiBBU1QuQmFzZU5vZGUpIHtcbiAgICBsZXQgbG9jID0gbm9kZS5sb2M7XG4gICAgaWYgKCFsb2MpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBsZXQgeyBzb3VyY2UsIHN0YXJ0LCBlbmQgfSA9IGxvYztcbiAgICByZXR1cm4gWydsb2MnLCBbc291cmNlIHx8IG51bGwsIFtzdGFydC5saW5lLCBzdGFydC5jb2x1bW5dLCBbZW5kLmxpbmUsIGVuZC5jb2x1bW5dXV07XG4gIH1cbn1cblxuZnVuY3Rpb24gaXNIZWxwZXJJbnZvY2F0aW9uKFxuICBtdXN0YWNoZTogQVNULk11c3RhY2hlU3RhdGVtZW50XG4pOiBtdXN0YWNoZSBpcyBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQgJiB7IHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbiB9IHtcbiAgcmV0dXJuIChcbiAgICAobXVzdGFjaGUucGFyYW1zICYmIG11c3RhY2hlLnBhcmFtcy5sZW5ndGggPiAwKSB8fFxuICAgIChtdXN0YWNoZS5oYXNoICYmIG11c3RhY2hlLmhhc2gucGFpcnMubGVuZ3RoID4gMClcbiAgKTtcbn1cblxuZnVuY3Rpb24gaXNTaW1wbGVQYXRoKHsgcGFydHMgfTogQVNULlBhdGhFeHByZXNzaW9uKTogYm9vbGVhbiB7XG4gIHJldHVybiBwYXJ0cy5sZW5ndGggPT09IDE7XG59XG5cbmZ1bmN0aW9uIGlzWWllbGQocGF0aDogQVNULlBhdGhFeHByZXNzaW9uKSB7XG4gIHJldHVybiBwYXRoLm9yaWdpbmFsID09PSAneWllbGQnO1xufVxuXG5mdW5jdGlvbiBpc1BhcnRpYWwocGF0aDogQVNULlBhdGhFeHByZXNzaW9uKSB7XG4gIHJldHVybiBwYXRoLm9yaWdpbmFsID09PSAncGFydGlhbCc7XG59XG5cbmZ1bmN0aW9uIGlzRGVidWdnZXIocGF0aDogQVNULlBhdGhFeHByZXNzaW9uKSB7XG4gIHJldHVybiBwYXRoLm9yaWdpbmFsID09PSAnZGVidWdnZXInO1xufVxuXG5mdW5jdGlvbiBpc0hhc0Jsb2NrKHBhdGg6IEFTVC5QYXRoRXhwcmVzc2lvbikge1xuICByZXR1cm4gcGF0aC5vcmlnaW5hbCA9PT0gJ2hhcy1ibG9jayc7XG59XG5cbmZ1bmN0aW9uIGlzSGFzQmxvY2tQYXJhbXMocGF0aDogQVNULlBhdGhFeHByZXNzaW9uKSB7XG4gIHJldHVybiBwYXRoLm9yaWdpbmFsID09PSAnaGFzLWJsb2NrLXBhcmFtcyc7XG59XG5cbmZ1bmN0aW9uIGlzQnVpbHRJbkhlbHBlcihwYXRoOiBBU1QuUGF0aEV4cHJlc3Npb24pIHtcbiAgcmV0dXJuIGlzSGFzQmxvY2socGF0aCkgfHwgaXNIYXNCbG9ja1BhcmFtcyhwYXRoKTtcbn1cblxuZnVuY3Rpb24gaXNBcmcocGF0aDogQVNULlBhdGhFeHByZXNzaW9uKTogYm9vbGVhbiB7XG4gIHJldHVybiAhIXBhdGhbJ2RhdGEnXTtcbn1cblxuZnVuY3Rpb24gaXNEeW5hbWljQ29tcG9uZW50KGVsZW1lbnQ6IEFTVC5FbGVtZW50Tm9kZSk6IGJvb2xlYW4ge1xuICBsZXQgb3BlbiA9IGVsZW1lbnQudGFnLmNoYXJBdCgwKTtcblxuICBsZXQgW21heWJlTG9jYWxdID0gZWxlbWVudC50YWcuc3BsaXQoJy4nKTtcbiAgbGV0IGlzTmFtZWRBcmd1bWVudCA9IG9wZW4gPT09ICdAJztcbiAgbGV0IGlzTG9jYWwgPSBlbGVtZW50WydzeW1ib2xzJ10uaGFzKG1heWJlTG9jYWwpO1xuICBsZXQgaXNUaGlzUGF0aCA9IGVsZW1lbnQudGFnLmluZGV4T2YoJ3RoaXMuJykgPT09IDA7XG5cbiAgcmV0dXJuIGlzTG9jYWwgfHwgaXNOYW1lZEFyZ3VtZW50IHx8IGlzVGhpc1BhdGg7XG59XG5cbmZ1bmN0aW9uIGlzQ29tcG9uZW50KGVsZW1lbnQ6IEFTVC5FbGVtZW50Tm9kZSk6IGJvb2xlYW4ge1xuICBsZXQgb3BlbiA9IGVsZW1lbnQudGFnLmNoYXJBdCgwKTtcbiAgbGV0IGlzUGF0aCA9IGVsZW1lbnQudGFnLmluZGV4T2YoJy4nKSA+IC0xO1xuXG4gIGxldCBpc1VwcGVyQ2FzZSA9IG9wZW4gPT09IG9wZW4udG9VcHBlckNhc2UoKSAmJiBvcGVuICE9PSBvcGVuLnRvTG93ZXJDYXNlKCk7XG5cbiAgcmV0dXJuIChpc1VwcGVyQ2FzZSAmJiAhaXNQYXRoKSB8fCBpc0R5bmFtaWNDb21wb25lbnQoZWxlbWVudCk7XG59XG5cbmZ1bmN0aW9uIGFzc2VydElzU2ltcGxlUGF0aChwYXRoOiBBU1QuUGF0aEV4cHJlc3Npb24sIGxvYzogQVNULlNvdXJjZUxvY2F0aW9uLCBjb250ZXh0OiBzdHJpbmcpIHtcbiAgaWYgKCFpc1NpbXBsZVBhdGgocGF0aCkpIHtcbiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoXG4gICAgICBgXFxgJHtwYXRoLm9yaWdpbmFsfVxcYCBpcyBub3QgYSB2YWxpZCBuYW1lIGZvciBhICR7Y29udGV4dH0gb24gbGluZSAke2xvYy5zdGFydC5saW5lfS5gLFxuICAgICAgcGF0aC5sb2NcbiAgICApO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFZhbGlkWWllbGQoc3RhdGVtZW50OiBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQpOiBzdHJpbmcge1xuICBsZXQgeyBwYWlycyB9ID0gc3RhdGVtZW50Lmhhc2g7XG5cbiAgaWYgKChwYWlycy5sZW5ndGggPT09IDEgJiYgcGFpcnNbMF0ua2V5ICE9PSAndG8nKSB8fCBwYWlycy5sZW5ndGggPiAxKSB7XG4gICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKGB5aWVsZCBvbmx5IHRha2VzIGEgc2luZ2xlIG5hbWVkIGFyZ3VtZW50OiAndG8nYCwgc3RhdGVtZW50LmxvYyk7XG4gIH0gZWxzZSBpZiAocGFpcnMubGVuZ3RoID09PSAxICYmIHBhaXJzWzBdLnZhbHVlLnR5cGUgIT09ICdTdHJpbmdMaXRlcmFsJykge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgeW91IGNhbiBvbmx5IHlpZWxkIHRvIGEgbGl0ZXJhbCB2YWx1ZWAsIHN0YXRlbWVudC5sb2MpO1xuICB9IGVsc2UgaWYgKHBhaXJzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAnZGVmYXVsdCc7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIChwYWlyc1swXS52YWx1ZSBhcyBBU1QuU3RyaW5nTGl0ZXJhbCkudmFsdWU7XG4gIH1cbn1cblxuZnVuY3Rpb24gYXNzZXJ0VmFsaWRQYXJ0aWFsKHN0YXRlbWVudDogQVNULk11c3RhY2hlU3RhdGVtZW50KSAvKiA6IGV4cHIgKi8ge1xuICBsZXQgeyBwYXJhbXMsIGhhc2gsIGVzY2FwZWQsIGxvYyB9ID0gc3RhdGVtZW50O1xuXG4gIGlmIChwYXJhbXMgJiYgcGFyYW1zLmxlbmd0aCAhPT0gMSkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcbiAgICAgIGBQYXJ0aWFsIGZvdW5kIHdpdGggbm8gYXJndW1lbnRzLiBZb3UgbXVzdCBzcGVjaWZ5IGEgdGVtcGxhdGUgbmFtZS4gKG9uIGxpbmUgJHtcbiAgICAgICAgbG9jLnN0YXJ0LmxpbmVcbiAgICAgIH0pYCxcbiAgICAgIHN0YXRlbWVudC5sb2NcbiAgICApO1xuICB9IGVsc2UgaWYgKGhhc2ggJiYgaGFzaC5wYWlycy5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKFxuICAgICAgYHBhcnRpYWwgZG9lcyBub3QgdGFrZSBhbnkgbmFtZWQgYXJndW1lbnRzIChvbiBsaW5lICR7bG9jLnN0YXJ0LmxpbmV9KWAsXG4gICAgICBzdGF0ZW1lbnQubG9jXG4gICAgKTtcbiAgfSBlbHNlIGlmICghZXNjYXBlZCkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcbiAgICAgIGB7e3twYXJ0aWFsIC4uLn19fSBpcyBub3Qgc3VwcG9ydGVkLCBwbGVhc2UgdXNlIHt7cGFydGlhbCAuLi59fSBpbnN0ZWFkIChvbiBsaW5lICR7XG4gICAgICAgIGxvYy5zdGFydC5saW5lXG4gICAgICB9KWAsXG4gICAgICBzdGF0ZW1lbnQubG9jXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiBwYXJhbXM7XG59XG5cbmZ1bmN0aW9uIGFzc2VydFZhbGlkSGFzQmxvY2tVc2FnZSh0eXBlOiBzdHJpbmcsIGNhbGw6IEFTVC5DYWxsKTogc3RyaW5nIHtcbiAgbGV0IHsgcGFyYW1zLCBoYXNoLCBsb2MgfSA9IGNhbGw7XG5cbiAgaWYgKGhhc2ggJiYgaGFzaC5wYWlycy5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKGAke3R5cGV9IGRvZXMgbm90IHRha2UgYW55IG5hbWVkIGFyZ3VtZW50c2AsIGNhbGwubG9jKTtcbiAgfVxuXG4gIGlmIChwYXJhbXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuICdkZWZhdWx0JztcbiAgfSBlbHNlIGlmIChwYXJhbXMubGVuZ3RoID09PSAxKSB7XG4gICAgbGV0IHBhcmFtID0gcGFyYW1zWzBdO1xuICAgIGlmIChwYXJhbS50eXBlID09PSAnU3RyaW5nTGl0ZXJhbCcpIHtcbiAgICAgIHJldHVybiBwYXJhbS52YWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKFxuICAgICAgICBgeW91IGNhbiBvbmx5IHlpZWxkIHRvIGEgbGl0ZXJhbCB2YWx1ZSAob24gbGluZSAke2xvYy5zdGFydC5saW5lfSlgLFxuICAgICAgICBjYWxsLmxvY1xuICAgICAgKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKFxuICAgICAgYCR7dHlwZX0gb25seSB0YWtlcyBhIHNpbmdsZSBwb3NpdGlvbmFsIGFyZ3VtZW50IChvbiBsaW5lICR7bG9jLnN0YXJ0LmxpbmV9KWAsXG4gICAgICBjYWxsLmxvY1xuICAgICk7XG4gIH1cbn1cblxuZnVuY3Rpb24gYXNzZXJ0VmFsaWREZWJ1Z2dlclVzYWdlKHN0YXRlbWVudDogQVNULk11c3RhY2hlU3RhdGVtZW50KSB7XG4gIGxldCB7IHBhcmFtcywgaGFzaCB9ID0gc3RhdGVtZW50O1xuXG4gIGlmIChoYXNoICYmIGhhc2gucGFpcnMubGVuZ3RoID4gMCkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgZGVidWdnZXIgZG9lcyBub3QgdGFrZSBhbnkgbmFtZWQgYXJndW1lbnRzYCwgc3RhdGVtZW50LmxvYyk7XG4gIH1cblxuICBpZiAocGFyYW1zLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAnZGVmYXVsdCc7XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKGBkZWJ1Z2dlciBkb2VzIG5vdCB0YWtlIGFueSBwb3NpdGlvbmFsIGFyZ3VtZW50c2AsIHN0YXRlbWVudC5sb2MpO1xuICB9XG59XG4iXX0=